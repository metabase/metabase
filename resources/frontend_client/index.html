<!DOCTYPE html>
<html lang="en" ng-app="corvus" class="no-js">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <title>Metabase</title>
        <link href="/app/bower_components/angular-xeditable/dist/css/xeditable.css" rel="stylesheet" />
        <link href="/app/bower_components/angular-gridster/dist/angular-gridster.min.css" rel="stylesheet" />
        <link href="/app/bower_components/react-date-picker/react-datepicker.css" rel="stylesheet" />
        <link href="/app/bower_components/dc.js/dc.css" rel="stylesheet" />
        <link rel="stylesheet" href="/app/dist/corvus.css" />
        <script src="/app/bower_components/angular/angular.min.js"></script>
    </head>

    <body ng-controller="Corvus">

        <div ng-controller="Nav" ng-if="user" ng-cloak>
            <!-- MAIN NAV -->
            <nav class="CoreNav clearfix" ng-show="nav === 'main'">
                <div class="col col-sm-12">
                    <div class="NavItem float-left" ng-if="!user.is_multi_org">
                        <span class="NavItem-text">{{currentOrg.name}}</span>
                    </div>
                    <div class="NavItem Dropdown float-left" dropdown on-toggle="toggled(open)" ng-if="user.is_multi_org">
                        <span dropdown-toggle>
                            <span class="NavItem-text" ng-bind="currentOrg.name"></span>
                            <cv-chevron-down-icon width="8px" height="8px"></cv-chevron-down-icon>
                        </span>
                        <ul class="Dropdown-content">
                            <li ng-repeat="organization in userMemberOf">
                                <a class="link block py1" href="#" ng-click="changeCurrOrg(organization.slug)">{{organization.name}}</a>
                            </li>
                        </ul>
                    </div>
                    <ul class="float-left ml4">
                        <li class="inline-block">
                            <a class="NavItem NavItem-withIcon" cv-org-href="/dash/" selectable-nav-item="dashboards">
                                <div class="IconWrapper">
                                    <cv-dashboards-icon></cv-dashboards-icon>
                                </div>
                                <span class="NavItem-text">Dashboards</span>
                            </a>
                        </li>
                        <li class="inline-block">
                            <a class="NavItem NavItem-withIcon" cv-org-href="/card/" selectable-nav-item="cards">
                                <div class="IconWrapper">
                                    <cv-cards-icon></cv-cards-icon>
                                </div>
                                <span class="NavItem-text">Cards</span>
                            </a>
                        </li>
                        <li class="inline-block">
                            <a class="NavItem NavItem-withIcon" cv-org-href="/explore/" selectable-nav-item="explore">
                                <div class="IconWrapper">
                                    <cv-explore-icon></cv-explore-icon>
                                </div>
                                <span class="NavItem-text">Explore</span>
                            </a>
                        </li>
                    </ul>
                    <ul class="float-right">
                        <li class="Dropdown inline-block" dropdown on-toggle="toggled(open)">
                            <a class="NavItem" selectable-nav-item="settings" dropdown-toggle>
                                <span class="NavItem-text" ng-if="!user.first_name">Me</span>
                                <span class="NavItem-text" ng-if="user.first_name">{{user.first_name}}</span>
                                <cv-chevron-down-icon width="8px" height="8px"></cv-chevron-down-icon>
                            </a>
                            <ul class="Dropdown-content right">
                                <li class="" ><a class="link" href="/user/edit_current">Account Settings</a></li>
                                <li class="" ><a class="link" ng-if="userIsAdmin" cv-org-href="/admin/">Admin</a></li>
                                <li class="" ><a class="link" ng-if="userIsSuperuser" href="/superadmin/">Site Administration</a></li>
                                <li class="" ><a class="link" href="/auth/logout">Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ADMIN NAV -->
            <nav class="AdminNav" ng-show="nav === 'admin'">
                <div class="wrapper flex align-center">
                    <!-- org title -->
                    <div class="NavTitle flex align-center" ng-if="!user.is_multi_org">
                        <cv-gear-icon class="AdminGear" width="22px" height="22px"></cv-gear-icon>
                        <span class="NavItem-text">{{currentOrg.name}} Admin</span>
                    </div>
                    <div class="NavTitle flex align-center Dropdown" dropdown on-toggle="toggled(open)" ng-if="user.is_multi_org">
                        <cv-gear-icon class="AdminGear" width="22px" height="22px"></cv-gear-icon>
                        <span dropdown-toggle>
                            <span class="NavItem-text">{{currentOrg.name}} Admin</span>
                            <cv-chevron-down-icon width="8px" height="8px"></cv-chevron-down-icon>
                        </span>
                        <ul class="Dropdown-content left">
                            <li ng-repeat="organization in userMemberOf">
                                <a class="link block py1" href="#" ng-click="changeCurrOrg(organization.slug, true)">{{organization.name}}</a>
                            </li>
                        </ul>
                    </div>

                    <!-- admin sections -->
                    <ul class="ml4 flex flex-full">
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/admin/org')}" cv-org-href="/admin/org/">
                                <span class="NavItem-text">Organization</span>
                            </a>
                        </li>
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/admin/people')}" cv-org-href="/admin/people/">
                                <span class="NavItem-text">People</span>
                            </a>
                        </li>
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/admin/databases')}" cv-org-href="/admin/databases/">
                                <span class="NavItem-text">Databases</span>
                            </a>
                        </li>
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/admin/query')}" cv-org-href="/admin/query/run">
                                <span class="NavItem-text">SQL Query</span>
                            </a>
                        </li>
                    </ul>

                    <!-- user profile dropdown -->
                    <mb-profile-link user="user" context="nav"></mb-profile-link>
                </div>
            </nav>

            <!-- SITE ADMINISTRATION (SUPER ADMIN) NAV -->
            <nav class="AdminNav" ng-show="nav === 'superadmin'">
                <div class="wrapper flex align-center">
                    <div class="NavTitle flex align-center">
                        <cv-gear-icon class="AdminGear" width="22px" height="22px"></cv-gear-icon>
                        <span class="NavItem-text ml1">Site Administration</span>
                    </div>

                    <ul class="ml4 flex flex-full">
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/superadmin/settings')}" href="/superadmin/settings/">
                                <span class="NavItem-text">Global Settings</span>
                            </a>
                        </li>
                        <li>
                            <a class="NavItem" ng-class="{ 'is--selected' : isActive('/superadmin/organization')}" href="/superadmin/organization/">
                                <span class="NavItem-text">Organizations</span>
                            </a>
                        </li>
                    </ul>

                    <!-- user profile dropdown -->
                    <mb-profile-link user="user" context="nav"></mb-profile-link>
                </div>
            </nav>

            <!-- SETUP NAV -->
            <nav class="SetupNav" ng-show="nav === 'setup'">
                <div class="SetupWrapper py4">
                    <span class="SetupOrg">
                        {{currentOrg.name}}
                    </span>
                    <span class="SetupUser float-right Dropdown" dropdown on-toggle="toggled(open)">
                        <div dropdown-toggle>
                            {{user.email}}
                            <cv-chevron-down-icon class="ml1" width="10px" height="10px"></cv-chevron-down-icon>
                          </div>
                        <ul class="Dropdown-content right">
                          <li class="" ><a class="link" href="/auth/logout">Logout</a></li>
                        </ul>
                    </span>
                </div>
            </nav>
        </div>

        <div class="MainContent flex flex-column full-height" ng-view></div>
    </body>

    <!-- JS INCLUDES -->
    <!-- vendor js -->
    <script src="/app/bower_components/react/react-with-addons.min.js"></script>
    <script src="/app/bower_components/react-onclickoutside/index.js"></script>
    <script src="/app/bower_components/moment/min/moment.min.js"></script>
    <script src="/app/bower_components/tether/tether.min.js"></script>
    <script src="/app/bower_components/react-date-picker/react-datepicker.js"></script>


    <script src="/app/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/app/bower_components/underscore/underscore-min.js"></script>
    <script src="/app/bower_components/fastclick/lib/fastclick.js"></script>

    <script src="/app/bower_components/angular-route/angular-route.min.js"></script>
    <script src="/app/bower_components/angular-resource/angular-resource.min.js"></script>
    <script src="/app/bower_components/angular-cookies/angular-cookies.min.js"></script>
    <script src="/app/bower_components/angular-animate/angular-animate.min.js"></script>
    <script src="/app/bower_components/angular-sanitize/angular-sanitize.min.js"></script>
    <script src="/app/bower_components/angular-xeditable/dist/js/xeditable.min.js"></script>
    <script src="/app/bower_components/angular-cookie/angular-cookie.min.js"></script>
    <script src="/app/bower_components/javascript-detect-element-resize/detect-element-resize.js"></script>
    <script src="/app/bower_components/angular-gridster/dist/angular-gridster.min.js"></script>
    <script src="/app/bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
    <script src="/app/bower_components/angular-http-auth/src/http-auth-interceptor.js"></script>
    <script src="/app/bower_components/ace-builds/src-min-noconflict/ace.js"></script>
    <script src="/app/bower_components/ace-builds/src-min-noconflict/mode-sql.js"></script>
    <script src="/app/bower_components/ace-builds/src-min-noconflict/ext-language_tools.js"></script>
    <script src="/app/bower_components/angular-ui-ace/ui-ace.min.js"></script>
    <script src="/app/bower_components/angularytics/dist/angularytics.min.js"></script>
    <script src="/app/bower_components/ng-sortable/dist/ng-sortable.min.js"></script>
    <script src="/app/bower_components/angular-readable-time/angular-readable-time.min.js"></script>

    <script src="/app/bower_components/d3/d3.min.js"></script>
    <script src="/app/bower_components/crossfilter/crossfilter.min.js"></script>
    <script src="/app/bower_components/dc.js/dc.min.js"></script>

    <script src="/app/js/google_maps.js"></script>

    <!-- dist app -->
    <script src="/app/dist/app.js"></script>
    <script src="/app/dist/query_builder.js" type="text/javascript"></script>

    <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
    <script>
        WebFont.load({
          google: {
            families: ['Lato:n2,n4,n7']
          }
        });
      </script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60817802-1', 'auto');
    ga('send', 'pageview');
    </script>
</html>
