name: Prepare Python Runner
description: |
  Prepare the Python runner environment for tests. This action starts the python-runner
  service using the Makefile, making it available for Python transform tests and driver tests.
inputs:
  submodules-token:
    description: 'GitHub token for accessing private submodules'
    required: false

runs:
  using: "composite"
  steps:
    - name: Initialize python-runner submodule
      shell: bash
      run: |
        echo "üì¶ Initializing python-runner submodule..."
        git submodule update --init --recursive python-runner
        echo "‚úÖ Submodule initialized successfully"
    
    - name: Check if python-runner directory exists
      id: check-python-runner
      shell: bash
      run: |
        if [ -d "python-runner" ]; then
          echo "exists=true" >> $GITHUB_OUTPUT
          echo "‚úÖ python-runner directory found"
        else
          echo "exists=false" >> $GITHUB_OUTPUT
          echo "‚ö†Ô∏è  python-runner directory not found - skipping Python runner setup"
        fi
    
    - name: Start python-runner using Makefile
      if: steps.check-python-runner.outputs.exists == 'true'
      shell: bash
      working-directory: python-runner
      run: |
        echo "üöÄ Starting python-runner using make run..."
        
        # Use the official make run command
        make run
        
        echo "‚úÖ Python runner started successfully!"