import cx from "classnames";
import { Link } from "react-router";
import { t } from "ttag";

import CS from "metabase/css/core/index.css";
import * as Urls from "metabase/lib/urls";
import { Anchor, Box, Card, FixedSizeIcon, Group, Stack } from "metabase/ui";
import type { DependencyNode } from "metabase-types/api";

import { getNodeTransform } from "../../../../utils";
import S from "../ListSidebar.module.css";

type SidebarTransformSectionProps = {
  node: DependencyNode;
};

export function SidebarTransformSection({
  node,
}: SidebarTransformSectionProps) {
  const transform = getNodeTransform(node);

  if (transform == null) {
    return null;
  }

  return (
    <Card
      p={0}
      shadow="none"
      withBorder
      role="region"
      aria-label={t`Transform`}
    >
      <Stack className={S.section} c="text-secondary" p="md" gap="xs">
        <Box fz="sm" lh="h5">
          {t`Generated by`}
        </Box>
        <Box lh="h4" c="text-primary">
          <Anchor
            component={Link}
            className={cx(CS.textWrap, S.link)}
            to={Urls.transform(transform.id)}
            target="_blank"
          >
            <Group gap="sm" wrap="nowrap">
              <FixedSizeIcon name="transform" />
              {transform.name}
            </Group>
            {}
          </Anchor>
        </Box>
      </Stack>
    </Card>
  );
}
