<section class="wrapper">
    <h2 class="py2">Run Query</h2>
    <form novalidate>
        <input type="hidden" name="q" value="{{queryResultData.uuid}}" ng-if="queryResultData"/>

        <div class="bg-white bordered rounded shadowed">
            <div class="p3">
                <label class="Select">
                    <select class="input" ng-model="query.database" ng-options="db.id as db.name for db in form_input['databases']">
                        <option value="">Select a database...</option>
                    </select>
                </label>

                <label class="Select mx2">
                    <select ng-model="query.timezone" ng-options="tz for tz in form_input['timezones']">
                        <option value="">Select a Timezone</option>
                    </select>
                </label>
            </div>

            <div class="border-top">
                <cv-ace-sql-editor sql="query.sql" database="query.database" onload="onEditorLoaded">
                </cv-ace-sql-editor>
            </div>

            <div class="p3 border-top">
                <div class="float-right">
                    <a class="Button" href="/api/qs/{{queryResultData.uuid}}/csv" target="_self" ng-if="queryResultData">Download Results</a>
                </div>

                <div class="inline-block">
                    <input class="Button Button--primary" type="button" value="Run" ng-click="runAdhocQuery(query)"/>
                </div>

                <div class="inline-block">
                    <input class="Button" type="button" value="Save" ng-click="saveAdhocQuery(query)"/>
                </div>
            </div>
        </div>
    </form>

    <div ng-include="'/app/admin/query/partials/query_detail_results.html?cb=4'"></div>

</section>
