(ns metabase-enterprise.metabot-v3.agent.profiles
  "Profile configurations for different metabot use cases.
  Each profile defines model settings, iteration limits, and available tools.")

(def profiles
  "Map of profile-id to profile configuration.

  Each profile includes:
  - :prompt-template - Selmer template name from resources/metabot/prompts/system/
  - :model - LLM model identifier
  - :max-iterations - Maximum agent loop iterations
  - :temperature - LLM temperature setting
  - :tools - Vector of tool names available to this profile"
  {:embedding_next
   {:prompt-template "embedding-next.selmer"
    :model "claude-haiku-4-5"
    :max-iterations 10
    :temperature 0.3
    :tools ["construct_notebook_query"
            "read_resource"
            "list_available_data_sources"]}

   :internal
   {:prompt-template "internal.selmer"
    :model "claude-haiku-4-5"
    :max-iterations 10
    :temperature 0.3
    :tools ["search"
            "construct_notebook_query"
            "read_resource"
            "create_sql_query"
            "edit_sql_query"
            "replace_sql_query"
            "edit_chart"
            "navigate_user"
            "create_chart"
            "create_autogenerated_dashboard"]}

   :transforms_codegen
   {:prompt-template "transform-codegen.selmer"
    :model "claude-haiku-4-5"
    :max-iterations 30
    :temperature 0.3
    :tools ["search"
            "get_transform_details"
            "get_transform_python_library_details"
            "write_transform_sql"
            "write_transform_python"
            "list_snippets"
            "get_snippet_details"
            "list_available_fields"
            "get_field_values"
            "todo_write"
            "todo_read"]}

   :sql
   {:prompt-template "sql-querying-only.selmer"
    :model "claude-haiku-4-5"
    :max-iterations 10
    :temperature 0.3
    :required-tool-call? true
    :tools ["search"
            "read_resource"
            "create_sql_query"
            "edit_sql_query"
            "replace_sql_query"
            "ask_for_sql_clarification"]}

   :nlq
   {:prompt-template "natural-language-querying-only.selmer"
    :model "claude-haiku-4-5"
    :max-iterations 10
    :temperature 0.3
    :tools ["search"
            "read_resource"
            "construct_notebook_query"
            "navigate_user"
            "create_chart"
            "edit_chart"]}})

(defn get-profile
  "Get profile configuration by profile-id keyword."
  [profile-id]
  (get profiles profile-id))
