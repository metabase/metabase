var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./shadow.js.shim.module$moment.js");require("./clojure.string.js");require("./metabase.mbql.normalize.js");require("./metabase.shared.util.i18n.js");
'use strict';var QJ=function(a){var b=new $CLJS.Ba;for(a=$CLJS.y(a);;)if(null!=a)b=b.append($CLJS.q.g($CLJS.z(a))),a=$CLJS.C(a);else return b.toString()},WJ=function(a){var b=UJ;if("string"===typeof a)return VJ(b,a);throw new TypeError("re-seq must match against a string.");},XJ=function(a){return new $CLJS.Ld(null,function(){return $CLJS.Jd(a.v?a.v():a.call(null),XJ(a))},null)},YJ=function(a,b){return new $CLJS.Ld(null,function(){var c=$CLJS.y(b);if(c){var d=$CLJS.z(c),e=a.g?a.g(d):a.call(null,d),
f=$CLJS.Jd(d,$CLJS.lg(function(g){return $CLJS.E.h(e,a.g?a.g(g):a.call(null,g))},$CLJS.C(c)));return $CLJS.Jd(f,YJ(a,new $CLJS.Ld(null,function(){return $CLJS.Ih($CLJS.D(f),c)},null)))}return null},null)},ZJ=function(a,b,c){var d=$CLJS.UC(a,/\{0\}/);d=$CLJS.E.h($CLJS.D(d),1)?new $CLJS.P(null,2,5,$CLJS.Q,[a,""],null):d;a=$CLJS.og(/.*\{0\}.*/,a);return $CLJS.yC.ngettext($CLJS.yC.msgid($CLJS.Fh(d),$CLJS.p(a)?c:""),b,c)},$J=function(a,b){switch(a){case "minutes":return ZJ("Minute","Minutes",b);case "hours":return ZJ("Hour",
"Hours",b);case "days":return ZJ("Day","Days",b);case "weeks":return ZJ("Week","Weeks",b);case "months":return ZJ("Month","Months",b);case "quarters":return ZJ("Quarter","Quarters",b);case "years":return ZJ("Year","Years",b);default:throw Error(["No matching clause: ",$CLJS.q.g(a)].join(""));}},aK=function(a,b,c){b=parseInt(b);c=$J(c,b);a=new $CLJS.P(null,2,5,$CLJS.Q,[a,$CLJS.E.h(b,1)],null);if($CLJS.E.h(new $CLJS.P(null,2,5,$CLJS.Q,["past",!0],null),a))return $CLJS.eD("Previous {0}",$CLJS.G([c]));
if($CLJS.E.h(new $CLJS.P(null,2,5,$CLJS.Q,["past",!1],null),a))return $CLJS.eD("Previous {0} {1}",$CLJS.G([b,c]));if($CLJS.E.h(new $CLJS.P(null,2,5,$CLJS.Q,["next",!0],null),a))return $CLJS.eD("Next {0}",$CLJS.G([c]));if($CLJS.E.h(new $CLJS.P(null,2,5,$CLJS.Q,["next",!1],null),a))return $CLJS.eD("Next {0} {1}",$CLJS.G([b,c]));throw Error(["No matching clause: ",$CLJS.q.g(a)].join(""));},cK=function(a){return $CLJS.XC(a,bK,function(b){return["\\",$CLJS.q.g(b)].join("")})},dK=function(a,b,c,d,e){this.tag=
a;this.source=b;this.C=c;this.l=d;this.B=e;this.A=2230716170;this.M=139264},fK=function(a){var b=$CLJS.UC(a,eK),c=$CLJS.xg.h($CLJS.z,WJ(a)),d=function(){var e=$CLJS.D(b),f=$CLJS.D(c);return e>f?e:f}();a=$CLJS.th.h(b,$CLJS.Po(d-$CLJS.D(b),XJ($CLJS.Ho(""))));d=$CLJS.th.h(c,$CLJS.Po(d-$CLJS.D(c),XJ($CLJS.Ho(""))));a=$CLJS.wG.h(a,d);return $CLJS.xg.h(function(e){var f=$CLJS.ng(UJ,e);return $CLJS.p(f)?($CLJS.I(f,0,null),f=$CLJS.I(f,1,null),new dK(f,e,null,null,null)):e},a)},gK=function(a){return $CLJS.Di(function(b){return"string"===
typeof $CLJS.z(b)?new $CLJS.P(null,1,5,$CLJS.Q,[QJ(b)],null):b},$CLJS.G([YJ(function(b){return"string"===typeof b||$CLJS.La($CLJS.zj.g(b))},a)]))},iK=function(a,b,c){return $CLJS.xg.h(function(d){if(d instanceof dK){var e=$CLJS.Cg.j;var f=$CLJS.Cj.g(d),g=$CLJS.K.h(a,f);f=$CLJS.zj.g(g);g=$CLJS.oj.g(g);if($CLJS.p(f))try{var l=cK(hK.j(g,f,b))}catch(k){if(k instanceof Error)l=hK.j($CLJS.mh,f,b);else throw k;}else l=null;d=e.call($CLJS.Cg,d,$CLJS.zj,l)}return d},c)},lK=function(a){a=QJ($CLJS.xg.h(function(b){return b instanceof
dK?b:$CLJS.XC(b,jK,"")},a));return $CLJS.XC(a,kK,$CLJS.Mc)},SJ=function(a){return $CLJS.RJ($CLJS.z(mK(new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.DP],null),new $CLJS.P(null,1,5,$CLJS.Q,[a],null))),$CLJS.yg)},VJ=function VJ(a,b){var d=a.exec(b);if(null==d)return null;var e=d[0],f=1===d.length?e:$CLJS.Ue(d);return $CLJS.Jd(f,new $CLJS.Ld(null,function(){var g=e.length;g=d.index+(1>g?1:g);return g<=b.length?(g=b.substring(g),VJ.h?VJ.h(a,g):VJ.call(null,a,g)):null},null))},mK=function mK(a,b){if($CLJS.La($CLJS.y(a)))a=
(0,$CLJS.IJ)(b);else{var d=$CLJS.K,e=d.h;var f=$CLJS.jg(a);b=$CLJS.he([$CLJS.Nc(a),b]);f=mK.h?mK.h(f,b):mK.call(null,f,b);a=e.call(d,f,$CLJS.Nc(a))}return a};var hK=function(){var a=$CLJS.vh.g($CLJS.ie),b=$CLJS.vh.g($CLJS.ie),c=$CLJS.vh.g($CLJS.ie),d=$CLJS.vh.g($CLJS.ie),e=$CLJS.K.j($CLJS.ie,$CLJS.kj,$CLJS.Th.v?$CLJS.Th.v():$CLJS.Th.call(null));return new $CLJS.NC($CLJS.Fg.h("metabase.shared.parameters.parameters","formatted-value"),function(f){return $CLJS.yg.g(f)},e,a,b,c,d)}();hK.ub(null,$CLJS.SR,function(a,b,c){return(0,$CLJS.Nh)(b).locale(c).format("MMMM D, YYYY")});
hK.ub(null,$CLJS.NP,function(a,b,c){a=(0,$CLJS.Nh)(b,"YYYY-MM").locale(c);return $CLJS.p(a.isValid())?a.format("MMMM, YYYY"):""});hK.ub(null,$CLJS.YQ,function(a,b,c){a=(0,$CLJS.Nh)(b,"[Q]Q-YYYY").locale(c);return $CLJS.p(a.isValid())?a.format("[Q]Q, YYYY"):""});hK.ub(null,$CLJS.iP,function(a,b,c){b=$CLJS.UC(b,/~/);a=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);return $CLJS.p($CLJS.p(a)?b:a)?[$CLJS.q.g(hK.j($CLJS.SR,a,c))," - ",$CLJS.q.g(hK.j($CLJS.SR,b,c))].join(""):""});
hK.ub(null,$CLJS.$Q,function(a,b){function c(d,e){return $CLJS.C($CLJS.og(d,e))}if(c(/^today$/,b)||c(/^thisday$/,b))return $CLJS.fD("Today");if(c(/^thisweek$/,b))return $CLJS.fD("This Week");if(c(/^thismonth$/,b))return $CLJS.fD("This Month");if(c(/^thisquarter$/,b))return $CLJS.fD("This Quarter");if(c(/^thisyear$/,b))return $CLJS.fD("This Year");if(c(/^past1days$/,b))return $CLJS.fD("Yesterday");if(c(/^next1days$/,b))return $CLJS.fD("Tomorrow");if(a=c(/^(past|next)([0-9]+)([a-z]+)~?$/,b))return $CLJS.fe.h(aK,
a);throw Error(["No matching clause: ",$CLJS.q.g(b)].join(""));});hK.ub(null,$CLJS.KW,function(a,b,c){function d(e,f){return $CLJS.Mc($CLJS.og(e,f))}a=d(/^(this[a-z]+)$/,b);if($CLJS.p(a))return hK.j($CLJS.$Q,a,c);a=d(/^~?([0-9-T:]+)~?$/,b);if($CLJS.p(a))return hK.j($CLJS.SR,a,c);a=d(/^([0-9-T:]+~[0-9-T:]+)$/,b);return $CLJS.p(a)?hK.j($CLJS.iP,a,c):hK.j($CLJS.$Q,b,c)});
hK.ub(null,$CLJS.mh,function(a,b){$CLJS.Wc(b)?(a=$CLJS.D(b),b=$CLJS.p($CLJS.E.h?$CLJS.E.h(1,a):$CLJS.E.call(null,1,a))?$CLJS.q.g($CLJS.z(b)):$CLJS.p($CLJS.E.h?$CLJS.E.h(2,a):$CLJS.E.call(null,2,a))?$CLJS.eD("{0} and {1}",$CLJS.G([$CLJS.z(b),$CLJS.Mc(b)])):$CLJS.eD("{0}, {1}, and {2}",$CLJS.G([$CLJS.Ko(", ",$CLJS.VC(2,b)),$CLJS.F(b,$CLJS.D(b)-2),$CLJS.Nc(b)]))):b=$CLJS.q.g(b);return b});var bK=/[\\\/*_`'\[\](){}<>#+-.!$@%^&=|\?~]/,UJ=/\{\{\s*([A-Za-z0-9_\.]+?)\s*\}\}/,eK=/\{\{\s*[A-Za-z0-9_\.]+?\s*\}\}/;
$CLJS.h=dK.prototype;$CLJS.h.toString=function(){var a=$CLJS.zj.g(this);return $CLJS.p(a)?a:this.source};$CLJS.h.ga=function(a,b){return this.N(null,b,null)};$CLJS.h.N=function(a,b,c){switch(b instanceof $CLJS.M?b.T:null){case "tag":return this.tag;case "source":return this.source;default:return $CLJS.K.j(this.l,b,c)}};$CLJS.h.oa=function(a,b,c){return $CLJS.qd(function(d,e){var f=$CLJS.I(e,0,null);e=$CLJS.I(e,1,null);return b.j?b.j(d,f,e):b.call(null,d,f,e)},c,this)};
$CLJS.h.S=function(a,b,c){return $CLJS.rg(b,function(d){return $CLJS.rg(b,$CLJS.wg,""," ","",c,d)},"#metabase.shared.parameters.parameters.TextParam{",", ","}",c,$CLJS.th.h(new $CLJS.P(null,2,5,$CLJS.Q,[new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.Cj,this.tag],null),new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.uY,this.source],null)],null),this.l))};$CLJS.h.ia=function(){return new $CLJS.kf(this,2,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.Cj,$CLJS.uY],null),$CLJS.p(this.l)?$CLJS.Wb(this.l):$CLJS.oe())};$CLJS.h.Z=function(){return this.C};
$CLJS.h.ba=function(){return 2+$CLJS.D(this.l)};$CLJS.h.X=function(){var a=this.B;return null!=a?a:this.B=a=-884441273^$CLJS.vc(this)};$CLJS.h.W=function(a,b){return null!=b&&this.constructor===b.constructor&&$CLJS.E.h(this.tag,b.tag)&&$CLJS.E.h(this.source,b.source)&&$CLJS.E.h(this.l,b.l)};
$CLJS.h.ra=function(a,b){return $CLJS.fd(new $CLJS.R(null,new $CLJS.n(null,2,[$CLJS.uY,null,$CLJS.Cj,null],null),null),b)?$CLJS.sh.h($CLJS.sb($CLJS.uf.h($CLJS.ie,this),this.C),b):new dK(this.tag,this.source,this.C,$CLJS.ke($CLJS.sh.h(this.l,b)),null)};$CLJS.h.ma=function(a,b){switch(b instanceof $CLJS.M?b.T:null){case "tag":case "source":return!0;default:return $CLJS.fd(this.l,b)}};
$CLJS.h.V=function(a,b,c){return $CLJS.p($CLJS.O.h?$CLJS.O.h($CLJS.Cj,b):$CLJS.O.call(null,$CLJS.Cj,b))?new dK(c,this.source,this.C,this.l,null):$CLJS.p($CLJS.O.h?$CLJS.O.h($CLJS.uY,b):$CLJS.O.call(null,$CLJS.uY,b))?new dK(this.tag,c,this.C,this.l,null):new dK(this.tag,this.source,this.C,$CLJS.Cg.j(this.l,b,c),null)};$CLJS.h.$=function(){return $CLJS.y($CLJS.th.h(new $CLJS.P(null,2,5,$CLJS.Q,[new $CLJS.gd($CLJS.Cj,this.tag),new $CLJS.gd($CLJS.uY,this.source)],null),this.l))};
$CLJS.h.aa=function(a,b){return new dK(this.tag,this.source,b,this.l,this.B)};$CLJS.h.ca=function(a,b){return $CLJS.Zc(b)?this.V(null,$CLJS.Pc(b,0),$CLJS.Pc(b,1)):$CLJS.qd($CLJS.Xa,this,b)};var jK=/\[\[.+\]\]/,kK=/\[\[(.+?)\]\]/,nK=function nK(a){switch(arguments.length){case 2:return nK.h(arguments[0],arguments[1]);case 3:return nK.j(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",$CLJS.q.g(arguments.length)].join(""));}};
$CLJS.Iu("metabase.shared.parameters.parameters.substitute_tags",nK);nK.h=function(a,b){return nK.j(a,b,"en")};nK.j=function(a,b,c){return $CLJS.p(a)?(b=$CLJS.qJ(b),b=$CLJS.TJ(b,SJ),lK(gK(iK(b,c,fK(a))))):null};nK.J=3;module.exports={tag_names:function(a){a=$CLJS.ig($CLJS.xg.h($CLJS.Mc,WJ($CLJS.p(a)?a:"")));return $CLJS.Fh(a)},substitute_tags:nK};