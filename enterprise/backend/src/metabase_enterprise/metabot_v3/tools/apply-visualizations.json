{
    "name": "apply-visualizations",
    "description": "Apply visualization settings including display type, filters, summarizations, and groupings. Leave the field null to keep the setting unchanged. Only use fields existing provided in the <context>. If unclear, ask for clarification.",
    "parameters": {
        "type": "object",
        "properties": {
            "display": {
                "title": "Visualization Display Type",
                "description": "Change the visualization. When summarization is used, this should be set appropriately with preference to line. For numeric results, scalar is preferred. When filtering, leave it `null` to avoid changing the display type.",
                "type": ["string", "null"],
                "enum": [
                    "pie",
                    "table",
                    "bar",
                    "line",
                    "row",
                    "area",
                    "scalar"
                ]
            },
            "filters": {
                "description": "Filter the data. Should be null if no filters are needed.",
                "type": ["array", "null"],
                "items": {
                    "additionalProperties": false,
                    "properties": {
                        "field": {
                            "description": "The field name to filter on. Needs to exist in the <context>.",
                            "title": "Field Name",
                            "type": "string"
                        },
                        "operator": {
                            "enum": [
                                "<",
                                "<=",
                                ">",
                                ">=",
                                "=",
                                "!=",
                                "contains",
                                "does-not-contain",
                                "starts-with"
                            ],
                            "title": "FilterOperator",
                            "type": "string"
                        },
                        "value": {
                            "description": "The value to filter.",
                            "title": "Value",
                            "type": ["string", "number"]
                        }
                    },
                    "required": [
                        "field",
                        "operator",
                        "value"
                    ],
                    "title": "FilterExpression",
                    "type": "object"
                }
            },
            "summarizations": {
                "description": "Summarize the data. Should be null if no summarizations are needed.",
                "type": ["array", "null"],
                "items": {
                    "type": "object",
                    "properties": {
                        "fieldName": {
                            "title": "Field Name",
                            "description": "The name of the field to summarize. Needs to exist in the <context>.",
                            "type": ["string", "null"]
                        },
                        "metrics": {
                            "title": "Summarization Metric",
                            "description": "The type of summarization to apply. COUNT does not require a field name.",
                            "type": "string",
                            "enum": ["sum", "count", "avg"]
                        }
                    },
                    "required": ["fieldName", "metrics"],
                    "additionalProperties": false
                }
            },
            "groups": {
                "description": "Group the data. Should be null if no grouping is needed.",
                "type": ["array", "null"],
                "items": {
                    "type": "object",
                    "properties": {
                        "fieldName": {
                            "title": "Field Name",
                            "description": "The name of the field to group by. Needs to exist in the <context>",
                            "type": "string"
                        },
                        "granularity": {
                            "title": "Granularity",
                            "description": "The granularity of grouping for date fields. Set to null for non-date fields.",
                            "type": ["string", "null"],
                            "enum": ["day", "week", "month", "year", null]
                        }
                    },
                    "required": ["fieldName", "granularity"],
                    "additionalProperties": false
                }
            }
        },
        "required": ["display", "filters", "summarizations", "groups"],
        "additionalProperties": false
    }
}
