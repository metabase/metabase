{
    "name": "create-dashboard-subscription",
    "description": "This is helpful when a user wants to be kept up to date on the contents of a dashboard.\n## When to use the create-dashboard-subscription tool\nUse this when a user wants to receive regular updates on a dashboard or send regular updates to another user. The user must have provided a valid email address or you received their email in the conversation history. You also need a valid dashboard ID and schedule supported by the tool arguments.\n## When not to use the create-dashboard-subscription tool\n* The user hasn't provided a valid email address (never infer email addresses from usernames or other information).\n* The schedule the user provided does not exactly match the supported schedules (e.g. not a full hour, unsupported day of month, etc.).",
    "parameters": {
        "type": "object",
        "properties": {
            "dashboard_id": {
                "type": "integer",
                "description": "The ID of the dashboard to subscribe to."
            },
            "email": {
                "type": "string",
                "description": "A valid and complete email address of the user to whom the dashboard should be sent. Do not infer email addresses from usernames or other information. If the email address is incomplete or missing a part like the TLD, ask the user for clarification before proceeding."
            },
            "schedule": {
                "description": "The schedule at which the dashboard should be sent.",
                "anyOf": [
                    {
                        "type": "object",
                        "properties": {
                            "frequency": {
                                "type": "string",
                                "enum": [
                                    "hourly"
                                ],
                                "description": "Frequency at which the dashboard should be sent"
                            }
                        },
                        "required": [
                            "frequency"
                        ],
                        "additionalProperties": false
                    },
                    {
                        "type": "object",
                        "properties": {
                            "frequency": {
                                "type": "string",
                                "enum": [
                                    "daily"
                                ],
                                "description": "Frequency at which the dashboard should be sent"
                            },
                            "hour": {
                                "type": "integer",
                                "description": "Hour at which the dashboard should be sent. Must be between 0 and 23. Can only be a full hour."
                            }
                        },
                        "required": [
                            "frequency",
                            "hour"
                        ],
                        "additionalProperties": false
                    },
                    {
                        "type": "object",
                        "properties": {
                            "frequency": {
                                "type": "string",
                                "enum": [
                                    "weekly"
                                ],
                                "description": "Frequency at which the dashboard should be sent"
                            },
                            "day_of_week": {
                                "type": "string",
                                "enum": [
                                    "sunday",
                                    "monday",
                                    "tuesday",
                                    "wednesday",
                                    "thursday",
                                    "friday",
                                    "saturday"
                                ],
                                "description": "Day of the week at which the dashboard should be sent"
                            },
                            "hour": {
                                "type": "integer",
                                "description": "Hour at which the dashboard should be sent. Must be between 0 and 23. Can only be a full hour."
                            }
                        },
                        "required": [
                            "frequency",
                            "day_of_week",
                            "hour"
                        ],
                        "additionalProperties": false
                    },
                    {
                        "type": "object",
                        "properties": {
                            "frequency": {
                                "type": "string",
                                "enum": [
                                    "monthly"
                                ],
                                "description": "Frequency at which the dashboard should be sent"
                            },
                            "day_of_month": {
                                "type": "string",
                                "enum": [
                                    "first-calendar-day",
                                    "first-sunday",
                                    "first-monday",
                                    "first-tuesday",
                                    "first-wednesday",
                                    "first-thursday",
                                    "first-friday",
                                    "first-saturday",
                                    "middle-of-month",
                                    "last-calendar-day",
                                    "last-sunday",
                                    "last-monday",
                                    "last-tuesday",
                                    "last-wednesday",
                                    "last-thursday",
                                    "last-friday",
                                    "last-saturday"
                                ],
                                "description": "Day of the month at which the dashboard should be sent. Can be the first or last day of the month or the first or last day of the week (e.g. first Monday, first Tuesday, last Thursday, etc.) or the middle of the month (15th)."
                            },
                            "hour": {
                                "type": "integer",
                                "description": "Hour at which the dashboard should be sent. Must be between 0 and 23. Can only be a full hour."
                            }
                        },
                        "required": [
                            "frequency",
                            "day_of_month",
                            "hour"
                        ],
                        "additionalProperties": false
                    }
                ]
            }
        },
        "required": [
            "dashboard_id",
            "email",
            "schedule"
        ],
        "additionalProperties": false
    },
    "examples": [
        "User: Send me updates on the dashboard every Wednesday at 8pm (user email: foo.bar@metabse.com)\nAssistant: {\"tool_name\": \"create-dashboard-subscription\", \"arguments\": {\"dashboard_id\": 1, \"email\": \"foo.bar@metabase.com\", \"schedule\": {\"frequency\": \"weekly\", \"day_of_week\": \"wednesday\", \"hour\": 20}}",
        "User: Send this dashboard to my colleague Mark every month\nAssistant: Sure. Please provide a valid email address for Mark. When should the dashboard be sent?\nUser: mark@metabase.com every 17th of the month\nAssistant: 17th of the month is not a valid option. The closest I can do is the 15th (middle of month). Should I proceed?\nUser: yes\nAssistant: {\"tool_name\": \"create-dashboard-subscription\", \"arguments\": {\"dashboard_id\": 1, \"email\": \"mark@metabase.com\", \"schedule\": {\"frequency\": \"monthly\", \"day_of_month\": \"middle-of-month\", \"hour\": 0}}",
        "User: Subscribe me to the dashboard every day at 14:15 (user email bar.foo@metabase.com)\nAssistant: Only full hours are supported. The closest I can do is every day at 14:00. Should I proceed?\nUser: yes\nAssistant: {\"tool_name\": \"create-dashboard-subscription\", \"arguments\": {\"dashboard_id\": 1, \"email\": \"bar.foo@metabase.com\", \"schedule\": {\"frequency\": \"daily\", \"hour\": 14}}",
        "User: Send this dashboard to the #insights slack channel every first day of the month in the morning.\nAssistant: Sorry I only can send dashboard subscriptions to users of your Metabase instance.",
        "User: Send this dashboard to Mike (mike@foobar.io) every hour\nAssistant: {\"tool_name\": \"create-dashboard-subscription\", \"arguments\": {\"dashboard_id\": 1, \"email\": \"mike@foobar.io\", \"schedule\": {\"frequency\": \"hourly\"}}\nTool Call Result: 'no user with this email found'\nAssistant: Seems that mike does not have an account in Metabase yet, should I invite him first?\nUser: No.",
        "User: Subscribe me to the dashboard every last Thursday of the month at 8am (user email: foo@bar.com),\nAssistant: {\"tool_name\": \"create-dashboard-subscription\", \"arguments\": {\"dashboard_id\": 1, \"email\": \"foo@bar.com\", \"schedule\": {\"frequency\": \"monthly\", \"day_of_month\": \"last-thursday\", \"hour\": 8}}"
    ]
}
