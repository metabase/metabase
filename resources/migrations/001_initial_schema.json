{
  "databaseChangeLog": [
    {
      "changeSet": {
        "id": "1",
        "author": "agilliland",
        "changes": [
          {
            "createTable": {
              "tableName": "core_organization",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "slug",
                    "type": "varchar(254)",
                    "constraints": {
                      "unique": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "logo_url",
                    "type": "varchar(254)"
                  }
                },
                {
                  "column": {
                    "name": "inherits",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "core_user",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "email",
                    "type": "varchar(254)",
                    "constraints": {
                      "unique": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "first_name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "last_name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "password",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "password_salt",
                    "type": "varchar(254)",
                    "defaultValue": "default",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "date_joined",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "last_login",
                    "type": "DATETIME",
                    "constraints": {"nullable": true}
                  }
                },
                {
                  "column": {
                    "name": "is_staff",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "is_superuser",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "is_active",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "reset_token",
                    "type": "varchar(254)"
                  }
                },
                {
                  "column": {
                    "name": "reset_triggered",
                    "type": "BIGINT"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "core_userorgperm",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "admin",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "user_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_userorgperm_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_userorgperm_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "addUniqueConstraint": {
              "tableName": "core_userorgperm",
              "constraintName": "idx_unique_user_id_organization_id",
              "columnNames": "user_id, organization_id"
            }
          },
          {
            "createIndex": {
              "tableName": "core_userorgperm",
              "indexName": "idx_userorgperm_user_id",
              "columns": [
                {
                  "column": {
                    "name": "user_id",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "core_userorgperm",
              "indexName": "idx_userorgperm_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "core_permissionsviolation",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "url",
                    "type": "varchar(254)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "timestamp",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "user_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_permissionviolation_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "core_permissionsviolation",
              "indexName": "idx_permissionsviolation_user_id",
              "columns": [
                {
                  "column": {
                    "name": "user_id",
                    "type": "int"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_database",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_database_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "details",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "engine",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_database",
              "indexName": "idx_database_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_table",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "rows",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "entity_name",
                    "type": "varchar(254)"
                  }
                },
                {
                  "column": {
                    "name": "entity_type",
                    "type": "varchar(254)"
                  }
                },
                {
                  "column": {
                    "name": "active",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "db_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_database(id)",
                      "foreignKeyName": "fk_table_ref_database_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_table",
              "indexName": "idx_table_db_id",
              "columns": [
                {
                  "column": {
                    "name": "db_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_field",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "base_type",
                    "type": "varchar(255)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "special_type",
                    "type": "varchar(255)"
                  }
                },
                {
                  "column": {
                    "name": "active",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "preview_display",
                    "type": "boolean",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "position",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "table_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_table(id)",
                      "foreignKeyName": "fk_field_ref_table_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "field_type",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_field",
              "indexName": "idx_field_table_id",
              "columns": [
                {
                  "column": {
                    "name": "table_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_foreignkey",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "relationship",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "destination_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_field(id)",
                      "foreignKeyName": "fk_foreignkey_dest_ref_field_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "origin_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_field(id)",
                      "foreignKeyName": "fk_foreignkey_origin_ref_field_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_foreignkey",
              "indexName": "idx_foreignkey_destination_id",
              "columns": [
                {
                  "column": {
                    "name": "destination_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_foreignkey",
              "indexName": "idx_foreignkey_origin_id",
              "columns": [
                {
                  "column": {
                    "name": "origin_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_fieldvalues",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "values",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "human_readable_values",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "field_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_field(id)",
                      "foreignKeyName": "fk_fieldvalues_ref_field_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_fieldvalues",
              "indexName": "idx_fieldvalues_field_id",
              "columns": [
                {
                  "column": {
                    "name": "field_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "metabase_tablesegment",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "table_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_table(id)",
                      "foreignKeyName": "fk_tablesegment_ref_table_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "filter_clause",
                    "type": "text",
                    "constraints": {
                      "nullable": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "metabase_tablesegment",
              "indexName": "idx_tablesegment_table_id",
              "columns": [
                {
                  "column": {
                    "name": "table_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "query_query",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "type",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "details",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "version",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "public_perms",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "creator_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_query_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "database_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "metabase_database(id)",
                      "foreignKeyName": "fk_query_ref_database_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "query_query",
              "indexName": "idx_query_creator_id",
              "columns": [
                {
                  "column": {
                    "name": "creator_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "query_query",
              "indexName": "idx_query_database_id",
              "columns": [
                {
                  "column": {
                    "name": "database_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "query_queryexecution",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "uuid",
                    "type": "varchar(254)",
                    "constraints": {
                      "nullable": false,
                      "unique": true
                    }
                  }
                },
                {
                  "column": {
                    "name": "version",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "json_query",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "raw_query",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "status",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "started_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "finished_at",
                    "type": "DATETIME"
                  }
                },
                {
                  "column": {
                    "name": "running_time",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "error",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "result_file",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "result_rows",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "result_data",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "query_id",
                    "type": "int",
                    "constraints": {
                      "nullable": true,
                      "references": "query_query(id)",
                      "foreignKeyName": "fk_queryexecution_ref_query_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "additional_info",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "executor_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_queryexecution_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "query_queryexecution",
              "indexName": "idx_queryexecution_query_id",
              "columns": [
                {
                  "column": {
                    "name": "query_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "query_queryexecution",
              "indexName": "idx_queryexecution_executor_id",
              "columns": [
                {
                  "column": {
                    "name": "executor_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_card",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "display",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "public_perms",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "dataset_query",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "visualization_settings",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "creator_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_card_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_card_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_card",
              "indexName": "idx_card_creator_id",
              "columns": [
                {
                  "column": {
                    "name": "creator_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_card",
              "indexName": "idx_card_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_cardfavorite",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "card_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "report_card(id)",
                      "foreignKeyName": "fk_cardfavorite_ref_card_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "owner_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_cardfavorite_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "addUniqueConstraint": {
              "tableName": "report_cardfavorite",
              "constraintName": "idx_unique_cardfavorite_card_id_owner_id",
              "columnNames": "card_id, owner_id"
            }
          },
          {
            "createIndex": {
              "tableName": "report_cardfavorite",
              "indexName": "idx_cardfavorite_card_id",
              "columns": [
                {
                  "column": {
                    "name": "card_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_cardfavorite",
              "indexName": "idx_cardfavorite_owner_id",
              "columns": [
                {
                  "column": {
                    "name": "owner_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_dashboard",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "public_perms",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "creator_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_dashboard_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_dashboard_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboard",
              "indexName": "idx_dashboard_creator_id",
              "columns": [
                {
                  "column": {
                    "name": "creator_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboard",
              "indexName": "idx_dashboard_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_dashboardcard",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "sizeX",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "sizeY",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "row",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "col",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "card_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "report_card(id)",
                      "foreignKeyName": "fk_dashboardcard_ref_card_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "dashboard_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "report_dashboard(id)",
                      "foreignKeyName": "fk_dashboardcard_ref_dashboard_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboardcard",
              "indexName": "idx_dashboardcard_card_id",
              "columns": [
                {
                  "column": {
                    "name": "card_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboardcard",
              "indexName": "idx_dashboardcard_dashboard_id",
              "columns": [
                {
                  "column": {
                    "name": "dashboard_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_dashboardsubscription",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "dashboard_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "report_dashboard(id)",
                      "foreignKeyName": "fk_dashboardsubscription_ref_dashboard_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "user_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_dashboardsubscription_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "addUniqueConstraint": {
              "tableName": "report_dashboardsubscription",
              "constraintName": "idx_uniq_dashsubscrip_dashboard_id_user_id",
              "columnNames": "dashboard_id, user_id"
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboardsubscription",
              "indexName": "idx_dashboardsubscription_dashboard_id",
              "columns": [
                {
                  "column": {
                    "name": "dashboard_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_dashboardsubscription",
              "indexName": "idx_dashboardsubscription_user_id",
              "columns": [
                {
                  "column": {
                    "name": "user_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_emailreport",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(254)",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "public_perms",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "mode",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "version",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "dataset_query",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "email_addresses",
                    "type": "text"
                  }
                },
                {
                  "column": {
                    "name": "creator_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_emailreport_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_emailreport_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "schedule",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreport",
              "indexName": "idx_emailreport_creator_id",
              "columns": [
                {
                  "column": {
                    "name": "creator_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreport",
              "indexName": "idx_emailreport_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_emailreport_recipients",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "emailreport_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "report_emailreport(id)",
                      "foreignKeyName": "fk_emailreport_recipients_ref_emailreport_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "user_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_emailreport_recipients_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "addUniqueConstraint": {
              "tableName": "report_emailreport_recipients",
              "constraintName": "idx_uniq_emailreportrecip_emailreport_id_user_id",
              "columnNames": "emailreport_id, user_id"
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreport_recipients",
              "indexName": "idx_emailreport_recipients_emailreport_id",
              "columns": [
                {
                  "column": {
                    "name": "emailreport_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreport_recipients",
              "indexName": "idx_emailreport_recipients_user_id",
              "columns": [
                {
                  "column": {
                    "name": "user_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "report_emailreportexecutions",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "details",
                    "type": "text",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "status",
                    "type": "varchar(254)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "started_at",
                    "type": "DATETIME"
                  }
                },
                {
                  "column": {
                    "name": "finished_at",
                    "type": "DATETIME"
                  }
                },
                {
                  "column": {
                    "name": "error",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "sent_email",
                    "type": "text",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_emailreportexecutions_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "report_id",
                    "type": "int",
                    "constraints": {
                      "nullable": true,
                      "references": "report_emailreport(id)",
                      "foreignKeyName": "fk_emailreportexecutions_ref_report_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreportexecutions",
              "indexName": "idx_emailreportexecutions_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "report_emailreportexecutions",
              "indexName": "idx_emailreportexecutions_report_id",
              "columns": [
                {
                  "column": {
                    "name": "report_id"
                  }
                }
              ]
            }
          },

          {
            "createTable": {
              "tableName": "annotation_annotation",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "int",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "created_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "updated_at",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "start",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "end",
                    "type": "DATETIME",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "title",
                    "type": "TEXT"
                  }
                },
                {
                  "column": {
                    "name": "body",
                    "type": "TEXT",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "annotation_type",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "edit_count",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "object_type_id",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "object_id",
                    "type": "int",
                    "constraints": {"nullable": false}
                  }
                },
                {
                  "column": {
                    "name": "author_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_user(id)",
                      "foreignKeyName": "fk_annotation_ref_user_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "organization_id",
                    "type": "int",
                    "constraints": {
                      "nullable": false,
                      "references": "core_organization(id)",
                      "foreignKeyName": "fk_annotation_ref_organization_id",
                      "deferrable": false,
                      "initiallyDeferred": false
                    }
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "annotation_annotation",
              "indexName": "idx_annotation_author_id",
              "columns": [
                {
                  "column": {
                    "name": "author_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "annotation_annotation",
              "indexName": "idx_annotation_organization_id",
              "columns": [
                {
                  "column": {
                    "name": "organization_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "annotation_annotation",
              "indexName": "idx_annotation_object_type_id",
              "columns": [
                {
                  "column": {
                    "name": "object_type_id"
                  }
                }
              ]
            }
          },
          {
            "createIndex": {
              "tableName": "annotation_annotation",
              "indexName": "idx_annotation_object_id",
              "columns": [
                {
                  "column": {
                    "name": "object_id"
                  }
                }
              ]
            }
          },

          {
            "modifySql": {
              "dbms": "postgresql",
              "replace": {
                "replace": "WITHOUT",
                "with": "WITH"
              }
            }
          }
        ]
      }
    }
  ]
}
