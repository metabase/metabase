var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.set.js");require("./clojure.walk.js");require("./medley.core.js");require("./metabase.mbql.util.js");require("./metabase.mbql.util.match.js");require("./metabase.shared.util.i18n.js");require("./metabase.util.log.js");
'use strict';var XG=function(a){return a instanceof Error?a.message:null},bH=function(a){var b=aH;return $CLJS.$G(function(c){return function(d,e,f){f=b.g?b.g(f):b.call(null,f);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)},dH=function(a){var b=cH;return $CLJS.$G(function(c){return function(d,e,f){e=b.g?b.g(e):b.call(null,e);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)},eH=function(a,b,c){var d=$CLJS.hd(a,b);if($CLJS.p(d)){var e=$CLJS.Cg.j;d=$CLJS.lb(d);c=c.g?c.g(d):c.call(null,d);a=e.call($CLJS.Cg,
a,b,c)}return a},fH=function(a,b,c){if($CLJS.Ed(c)){var d=$CLJS.fe.h($CLJS.U,$CLJS.xg.h(a,c));return b.g?b.g(d):b.call(null,d)}return $CLJS.Pe(c)?(d=new $CLJS.gd(function(){var e=$CLJS.kb(c);return a.g?a.g(e):a.call(null,e)}(),function(){var e=$CLJS.lb(c);return a.g?a.g(e):a.call(null,e)}()),b.g?b.g(d):b.call(null,d)):$CLJS.Hh(c)?(d=$CLJS.YG($CLJS.xg.h(a,c)),b.g?b.g(d):b.call(null,d)):$CLJS.Yc(c)?(d=$CLJS.qd(function(e,f){return $CLJS.Gd.h(e,a.g?a.g(f):a.call(null,f))},c,c),b.g?b.g(d):b.call(null,
d)):$CLJS.Uc(c)?(d=$CLJS.uf.h($CLJS.Oc(c),$CLJS.xg.h(a,c)),b.g?b.g(d):b.call(null,d)):b.g?b.g(c):b.call(null,c)},hH=function(a){function b(c){var d=$CLJS.I(c,0,null);c=$CLJS.I(c,1,null);return"string"===typeof d?new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.yg.g(d),c],null):new $CLJS.P(null,2,5,$CLJS.Q,[d,c],null)}return gH(function(c){return $CLJS.Xc(c)?$CLJS.uf.h($CLJS.ie,$CLJS.xg.h(b,c)):c},a)},mH=function(a){var b=$CLJS.Wc(a);return b?(b=!$CLJS.Pe(a))?$CLJS.yh.h($CLJS.sm,$CLJS.mm)($CLJS.z(a)):b:b},cH=function(a){return $CLJS.p($CLJS.yh.h($CLJS.sm,
$CLJS.mm)(a))?$CLJS.mE(a):a},nH=function(a,b){var c=mH(b);return $CLJS.p(c)?(b=cH($CLJS.z(b)),$CLJS.Uc(a)?(a=$CLJS.ig(a),a.g?a.g(b):a.call(null,b)):$CLJS.E.h(a,b)):c},qH=function(a){return $CLJS.K.j(new $CLJS.n(null,3,[$CLJS.mh,$CLJS.xd,$CLJS.oj,cH,$CLJS.oQ,cH],null),a,function(b){var c=$CLJS.K,d=c.h;b=$CLJS.he([a,b]);b=oH.h?oH.h(b,sY):oH.call(null,b,sY);return d.call(c,b,a)})},rH=function(a){a=$CLJS.uf.j($CLJS.ie,$CLJS.xg.g(function(b){var c=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);c=cH(c);var d=qH(c);
return new $CLJS.P(null,2,5,$CLJS.Q,[c,d.g?d.g(b):d.call(null,b)],null)}),a);return $CLJS.E.h($CLJS.oj.g(a),$CLJS.lO)&&$CLJS.La($CLJS.oQ.g(a))?$CLJS.Cg.j(a,$CLJS.oQ,$CLJS.CV):a},sH=function(a){return $CLJS.uf.j($CLJS.ie,$CLJS.xg.g(function(b){var c=$CLJS.I(b,0,null);b=$CLJS.I(b,1,null);c=$CLJS.gD(c);return new $CLJS.P(null,2,5,$CLJS.Q,[c,$CLJS.Cg.j(rH(b),$CLJS.S,c)],null)}),a)},wH=function(a){return eH(eH($CLJS.qd(function(b,c){return eH(b,c,$CLJS.yg)},a,new $CLJS.P(null,6,5,$CLJS.Q,[$CLJS.AL,$CLJS.YL,
$CLJS.nR,tY,$CLJS.uY,$CLJS.Vh],null)),vY,$CLJS.Li.h(aH,oH)),$CLJS.pQ,hH)},xH=function(a){return $CLJS.dd(a)?new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,a,null],null):a},zH=function(a){return yH.g(xH(a))},AH=function(a){var b=$CLJS.y(a);a=$CLJS.z(b);b=$CLJS.C(b);return $CLJS.kD($CLJS.uf.h(new $CLJS.P(null,1,5,$CLJS.Q,[a],null),$CLJS.xg.h(yH,b)))},BH=function(a){var b=$CLJS.y(a);a=$CLJS.z(b);var c=$CLJS.C(b);b=$CLJS.z(c);c=$CLJS.C(c);return $CLJS.uf.h(new $CLJS.P(null,2,5,$CLJS.Q,[a,zH(b)],null),$CLJS.xg.h(yH,
c))},CH=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return $CLJS.p(a)?new $CLJS.P(null,2,5,$CLJS.Q,[b,zH(a)],null):new $CLJS.P(null,1,5,$CLJS.Q,[b],null)},DH=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.P(null,2,5,$CLJS.Q,[b,zH(a)],null)},EH=function(a){var b=$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.P(null,2,5,$CLJS.Q,[b,yH.g(a)],null)},aH=function(a){return FH(function(b){if($CLJS.Xc(b))return bH(b);if($CLJS.La(mH(b)))return b;try{return yH.g(b)}catch(f){if(f instanceof
Error){var c=f,d=$CLJS.CJ($CLJS.Pu);if($CLJS.p($CLJS.DJ("metabase.mbql.normalize",d))){var e=$CLJS.fD("Invalid clause:");e instanceof Error?$CLJS.lH("metabase.mbql.normalize",d,$CLJS.oy.o($CLJS.G([b])),e):$CLJS.lH("metabase.mbql.normalize",d,$CLJS.oy.o($CLJS.G([e,b])),null)}throw $CLJS.Io($CLJS.eD("Invalid MBQL clause: {0}",$CLJS.G([XG(c)])),new $CLJS.n(null,1,[$CLJS.IW,b],null),c);}throw f;}},a)},IH=function(a){return $CLJS.Ue($CLJS.ve(aH,HH(a)))},JH=function(a){for(;;)if($CLJS.p(mH(a)))a=new $CLJS.P(null,
1,5,$CLJS.Q,[a],null);else return $CLJS.ke($CLJS.Ah.h(xH,a))},KH=function(a){a=$CLJS.je(a);var b=$CLJS.K.h(a,$CLJS.lO);return $CLJS.p(b)?$CLJS.BD.j(a,$CLJS.lO,yH):a},LH=function(a){return $CLJS.uf.h($CLJS.ie,function(){return function d(c){return new $CLJS.Ld(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.ad(e)){var f=$CLJS.Rb(e),g=$CLJS.D(f),l=$CLJS.Od(g);a:for(var k=0;;)if(k<g){var m=$CLJS.Pc(f,k),r=$CLJS.I(m,0,null);m=$CLJS.I(m,1,null);r=new $CLJS.P(null,2,5,$CLJS.Q,[r,KH(m)],null);l.add(r);
k+=1}else{f=!0;break a}return f?$CLJS.Rd($CLJS.Td(l),d($CLJS.Sb(e))):$CLJS.Rd($CLJS.Td(l),null)}f=$CLJS.z(e);l=$CLJS.I(f,0,null);f=$CLJS.I(f,1,null);return $CLJS.Jd(new $CLJS.P(null,2,5,$CLJS.Q,[l,KH(f)],null),d($CLJS.qc(e)))}return null}},null)}(a)}())},OH=function(a){a=$CLJS.je(a);var b=$CLJS.K.h(a,$CLJS.AU);return $CLJS.p(b)?$CLJS.BD.j(a,$CLJS.AU,LH):a},QH=function(a){var b=$CLJS.je(a);a=$CLJS.K.h(b,$CLJS.QT);b=$CLJS.La(a)?PH.g?PH.g(b):PH.call(null,b):b;return $CLJS.p(a)?OH(b):b},RH=function(a){return $CLJS.Uc(a)?
$CLJS.y(a):null!=a},TH=function(a){var b=$CLJS.je(a);a=$CLJS.K.h(b,$CLJS.JO);var c=$CLJS.K.h(b,$CLJS.DP),d=$CLJS.K.h(b,$CLJS.HR),e=$CLJS.K.h(b,$CLJS.QT);try{if($CLJS.p(d)){var f=$CLJS.je(b),g=$CLJS.K.h(f,$CLJS.HR);var l=SH($CLJS.sh.h(f,$CLJS.HR),new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.JO,$CLJS.HR],null),g)}else l=b;var k=$CLJS.p(a)?$CLJS.BD.j(l,$CLJS.JO,PH):l,m=$CLJS.p(c)?$CLJS.BD.j(k,$CLJS.DP,$CLJS.wi($CLJS.Ah,aH)):k,r=$CLJS.p(e)?$CLJS.BD.j(m,$CLJS.QT,OH):m;return aH(r)}catch(v){if(v instanceof Error)throw k=
v,$CLJS.Io($CLJS.eD("Error canonicalizing query: {0}",$CLJS.G([XG(k)])),new $CLJS.n(null,1,[$CLJS.JO,a],null),k);throw v;}},VH=function(a){a=$CLJS.je(a);var b=$CLJS.K.h(a,$CLJS.JO),c=$CLJS.je(b);b=$CLJS.K.h(c,$CLJS.tR);c=$CLJS.K.h(c,$CLJS.UO);return $CLJS.y(b)&&$CLJS.y(c)?(b=$CLJS.ig($CLJS.ud($CLJS.th,$CLJS.y($CLJS.Be($CLJS.Do,function g(e,f){try{if($CLJS.Zc(f)&&3===$CLJS.D(f))try{var l=$CLJS.F(f,0);if($CLJS.O(l,$CLJS.aT)){var k=$CLJS.F(f,1),m=$CLJS.F(f,2);return new $CLJS.P(null,1,5,$CLJS.Q,[new $CLJS.P(null,
2,5,$CLJS.Q,[f,new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,k,$CLJS.sh.h(m,$CLJS.JT)],null)],null)],null)}throw $CLJS.Z;}catch(r){if(r instanceof Error){l=r;if(l===$CLJS.Z)throw $CLJS.Z;throw l;}throw r;}else throw $CLJS.Z;}catch(r){if(r instanceof Error){l=r;if(l===$CLJS.Z)return $CLJS.cD(g,e,f);throw l;}throw r;}}($CLJS.Te,b))))),UH.j(a,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.JO,$CLJS.UO],null),$CLJS.Li.h($CLJS.Ue,$CLJS.wi($CLJS.zh,b)))):a},WH=function(a){try{return VH(a)}catch(c){if(c instanceof Error){var b=
c;throw $CLJS.Io($CLJS.fD("Error performing whole query transformations"),new $CLJS.n(null,1,[$CLJS.JO,a],null),b);}throw c;}},YH=function(a,b){var c=$CLJS.uf.h($CLJS.Oc(a),function(){return function f(e){return new $CLJS.Ld(null,function(){for(var g=e;;)if(g=$CLJS.y(g)){if($CLJS.ad(g)){var l=$CLJS.Rb(g),k=$CLJS.D(l),m=$CLJS.Od(k);return function(){for(var x=0;;)if(x<k){var A=$CLJS.Pc(l,x),H=$CLJS.I(A,0,null);A=$CLJS.I(A,1,null);var N=$CLJS.Gd.h(b,H);A=XH.h?XH.h(A,N):XH.call(null,A,N);null!=A&&m.add(new $CLJS.P(null,
2,5,$CLJS.Q,[H,A],null));x+=1}else return!0}()?$CLJS.Rd($CLJS.Td(m),f($CLJS.Sb(g))):$CLJS.Rd($CLJS.Td(m),null)}var r=$CLJS.z(g),v=$CLJS.I(r,0,null),w=$CLJS.I(r,1,null);r=function(){var x=w,A=$CLJS.Gd.h(b,v);return XH.h?XH.h(x,A):XH.call(null,x,A)}();if(null!=r)return $CLJS.Jd(new $CLJS.P(null,2,5,$CLJS.Q,[v,r],null),f($CLJS.qc(g)));g=$CLJS.qc(g)}else return null},null)}(a)}());return $CLJS.y(c)?c:null},$H=function(a,b){a=$CLJS.Ah.h(function(c){var d=$CLJS.Gd.h(b,wY);return XH.h?XH.h(c,d):XH.call(null,
c,d)},a);return $CLJS.p($CLJS.se($CLJS.Do,a))?a:null},SH=function SH(a,b,c){var e=$CLJS.y(b);b=$CLJS.z(e);var f=$CLJS.C(e);if(f){e=$CLJS.Cg.j;var g=$CLJS.K.h(a,b);c=SH.j?SH.j(g,f,c):SH.call(null,g,f,c);a=e.call($CLJS.Cg,a,b,c)}else a=$CLJS.Cg.j(a,b,c);return a},UH=function UH(a){switch(arguments.length){case 3:return UH.j(arguments[0],arguments[1],arguments[2]);case 4:return UH.O(arguments[0],arguments[1],arguments[2],arguments[3]);case 5:return UH.ea(arguments[0],arguments[1],arguments[2],arguments[3],
arguments[4]);case 6:return UH.qa(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);default:for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return UH.o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],new $CLJS.lc(c.slice(6),0,null))}},FH,gH,xY,yY,zY,AY,BY,CY,DY,EY,FY,GY,HY,IY,JY,KY,LY,wY,sY,MY,NY,vY,OY,tY;
UH.j=function(a,b,c){var d=$CLJS.y(b);b=$CLJS.z(d);if(d=$CLJS.C(d))a=$CLJS.Cg.j(a,b,UH.j($CLJS.K.h(a,b),d,c));else{d=$CLJS.Cg.j;var e=$CLJS.K.h(a,b);c=c.g?c.g(e):c.call(null,e);a=d.call($CLJS.Cg,a,b,c)}return a};UH.O=function(a,b,c,d){var e=$CLJS.y(b);b=$CLJS.z(e);if(e=$CLJS.C(e))a=$CLJS.Cg.j(a,b,UH.O($CLJS.K.h(a,b),e,c,d));else{e=$CLJS.Cg.j;var f=$CLJS.K.h(a,b);c=c.h?c.h(f,d):c.call(null,f,d);a=e.call($CLJS.Cg,a,b,c)}return a};
UH.ea=function(a,b,c,d,e){var f=$CLJS.y(b);b=$CLJS.z(f);if(f=$CLJS.C(f))a=$CLJS.Cg.j(a,b,UH.ea($CLJS.K.h(a,b),f,c,d,e));else{f=$CLJS.Cg.j;var g=$CLJS.K.h(a,b);c=c.j?c.j(g,d,e):c.call(null,g,d,e);a=f.call($CLJS.Cg,a,b,c)}return a};UH.qa=function(a,b,c,d,e,f){var g=$CLJS.y(b);b=$CLJS.z(g);if(g=$CLJS.C(g))a=$CLJS.Cg.j(a,b,UH.qa($CLJS.K.h(a,b),g,c,d,e,f));else{g=$CLJS.Cg.j;var l=$CLJS.K.h(a,b);c=c.O?c.O(l,d,e,f):c.call(null,l,d,e,f);a=g.call($CLJS.Cg,a,b,c)}return a};
UH.o=function(a,b,c,d,e,f,g){var l=$CLJS.y(b);b=$CLJS.z(l);return(l=$CLJS.C(l))?$CLJS.Cg.j(a,b,$CLJS.fe.o(UH,$CLJS.K.h(a,b),l,c,d,$CLJS.G([e,f,g]))):$CLJS.Cg.j(a,b,$CLJS.fe.o(c,$CLJS.K.h(a,b),d,e,f,$CLJS.G([g])))};UH.I=function(a){var b=$CLJS.z(a),c=$CLJS.C(a);a=$CLJS.z(c);var d=$CLJS.C(c);c=$CLJS.z(d);var e=$CLJS.C(d);d=$CLJS.z(e);var f=$CLJS.C(e);e=$CLJS.z(f);var g=$CLJS.C(f);f=$CLJS.z(g);g=$CLJS.C(g);return this.o(b,a,c,d,e,f,g)};UH.J=6;
FH=function FH(a,b){return fH($CLJS.wi(FH,a),$CLJS.xd,a.g?a.g(b):a.call(null,b))};gH=function gH(a,b){return fH($CLJS.wi(gH,a),a,b)};xY=new $CLJS.M(null,"value_field","value_field",-980977878);yY=new $CLJS.M(null,"ascending","ascending",-988350486);zY=new $CLJS.M(null,"named","named",-422393479);AY=new $CLJS.M(null,"values_source_config","values_source_config",-590570309);BY=new $CLJS.M(null,"as","as",1148689641);CY=new $CLJS.M(null,"field-id","field-id",-353751335);
DY=new $CLJS.M(null,"form","form",-1624062471);$CLJS.uY=new $CLJS.M(null,"source","source",-433931539);EY=new $CLJS.M(null,"descending","descending",-24766135);FY=new $CLJS.M(null,"binning-strategy","binning-strategy",2063329158);GY=new $CLJS.M(null,"datetime-field","datetime-field",21731696);HY=new $CLJS.M(null,"use-as-display-name?","use-as-display-name?",686752941);IY=new $CLJS.M(null,"field-literal","field-literal",-1295883554);JY=new $CLJS.M(null,"viz-settings","viz-settings",256055379);
KY=new $CLJS.M(null,"rows","rows",850049680);LY=new $CLJS.M(null,"special-fn","special-fn",1290649344);wY=new $CLJS.M("metabase.mbql.normalize","sequence","metabase.mbql.normalize/sequence",-1700645683);sY=new $CLJS.M(null,"ignore-path","ignore-path",944069061);MY=new $CLJS.M(null,"label_field","label_field",-1573182765);NY=new $CLJS.M(null,"fk-\x3e","fk-\x3e",-499026738);vY=new $CLJS.M(null,"field_ref","field_ref",-1985640334);OY=new $CLJS.M(null,"joined-field","joined-field",-2048778268);
tY=new $CLJS.M(null,"visibility_type","visibility_type",-508434247);var qI,PY=$CLJS.vh.g($CLJS.ie),QY=$CLJS.vh.g($CLJS.ie),RY=$CLJS.vh.g($CLJS.ie),SY=$CLJS.vh.g($CLJS.ie),TY=$CLJS.K.j($CLJS.ie,$CLJS.kj,$CLJS.Th.v?$CLJS.Th.v():$CLJS.Th.call(null));qI=new $CLJS.NC($CLJS.Fg.h("metabase.mbql.normalize","normalize-mbql-clause-tokens"),$CLJS.Li.h(cH,$CLJS.z),TY,PY,QY,RY,SY);qI.ub(null,$CLJS.fv,function(a){$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.fv,a instanceof $CLJS.M?$CLJS.gD(a):a],null)});
qI.ub(null,FY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.p(a)?$CLJS.Gd.h(qI.g(new $CLJS.P(null,3,5,$CLJS.Q,[FY,b,c],null)),a):new $CLJS.P(null,3,5,$CLJS.Q,[FY,oH.h?oH.h(b,sY):oH.call(null,b,sY),cH(c)],null)});
qI.ub(null,$CLJS.aT,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);var c=oH.h?oH.h(a,sY):oH.call(null,a,sY);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,b,function(){var d=$CLJS.p($CLJS.fU.g(c))?$CLJS.BD.j(c,$CLJS.fU,$CLJS.yg):c;d=$CLJS.p($CLJS.JT.g(c))?$CLJS.BD.j(d,$CLJS.JT,$CLJS.yg):d;return $CLJS.p($CLJS.WV.g(c))?$CLJS.BD.j(d,$CLJS.WV,function(e){return $CLJS.p($CLJS.PW.g(e))?$CLJS.BD.j(e,$CLJS.PW,$CLJS.yg):e}):d}()],null)});
qI.ub(null,IY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[IY,b instanceof $CLJS.M?$CLJS.gD(b):b,$CLJS.yg.g(a)],null)});qI.ub(null,GY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.p(a)?new $CLJS.P(null,4,5,$CLJS.Q,[GY,oH.h?oH.h(b,sY):oH.call(null,b,sY),BY,cH(a)],null):new $CLJS.P(null,3,5,$CLJS.Q,[GY,oH.h?oH.h(b,sY):oH.call(null,b,sY),cH(c)],null)});
qI.ub(null,$CLJS.IU,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null),d=$CLJS.I(a,3,null);a=$CLJS.I(a,4,null);return $CLJS.p(a)?$CLJS.Gd.h(qI.g(new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.IU,b,c,d],null)),oH.h?oH.h(a,sY):oH.call(null,a,sY)):new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.IU,oH.h?oH.h(b,sY):oH.call(null,b,sY),$CLJS.dd(c)?c:cH(c),cH(d)],null)});
qI.ub(null,$CLJS.GR,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.p(a)?new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.GR,b,cH(a)],null):new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.GR,$CLJS.Dx],null)});qI.ub(null,$CLJS.IQ,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.IQ,b,cH(a)],null)});
qI.ub(null,$CLJS.ZT,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.ZT,oH.h?oH.h(b,sY):oH.call(null,b,sY),c,cH(a)],null)});qI.ub(null,$CLJS.HV,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.HV,oH.h?oH.h(b,sY):oH.call(null,b,sY),c,cH(a)],null)});
qI.ub(null,$CLJS.XT,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.p(a)?new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.XT,oH.h?oH.h(b,sY):oH.call(null,b,sY),cH(a)],null):new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.XT,oH.h?oH.h(b,sY):oH.call(null,b,sY)],null)});
qI.ub(null,$CLJS.GU,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return $CLJS.p(a)?new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.GU,oH.h?oH.h(b,sY):oH.call(null,b,sY),cH(c),cH(a)],null):new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.GU,oH.h?oH.h(b,sY):oH.call(null,b,sY),cH(c)],null)});
qI.ub(null,$CLJS.EQ,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null);a=$CLJS.I(a,3,null);return new $CLJS.P(null,4,5,$CLJS.Q,[$CLJS.EQ,oH.h?oH.h(b,sY):oH.call(null,b,sY),oH.h?oH.h(c,sY):oH.call(null,c,sY),cH(a)],null)});qI.ub(null,$CLJS.zj,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.zj,b,a],null)});
qI.ub(null,$CLJS.mh,function(a){var b=$CLJS.y(a);a=$CLJS.z(b);b=$CLJS.C(b);return $CLJS.uf.j(new $CLJS.P(null,1,5,$CLJS.Q,[cH(a)],null),$CLJS.xg.g(function(c){return oH.h?oH.h(c,sY):oH.call(null,c,sY)}),b)});
var wI=function wI(a){if($CLJS.p($CLJS.yh.h($CLJS.sm,$CLJS.mm)(a))){var c=cH(a);var d=new $CLJS.R(null,new $CLJS.n(null,18,[$CLJS.Qi,null,$CLJS.hk,null,$CLJS.eV,null,$CLJS.bU,null,$CLJS.fW,null,$CLJS.eT,null,$CLJS.TV,null,$CLJS.aW,null,$CLJS.vP,null,$CLJS.bR,null,$CLJS.gk,null,$CLJS.KP,null,$CLJS.TU,null,$CLJS.LT,null,$CLJS.Tj,null,$CLJS.FF,null,$CLJS.gS,null,$CLJS.OU,null],null),null);c=d.g?d.g(c):d.call(null,c)}else c=null;return $CLJS.p(c)?c:$CLJS.p(mH(a))?(a=$CLJS.z(a),wI.g?wI.g(a):wI.call(null,
a)):null},yI=new $CLJS.n(null,8,[$CLJS.oj,cH,$CLJS.QT,function(a){a=dH(a);return $CLJS.y($CLJS.AU.g(a))?$CLJS.BD.j(a,$CLJS.AU,sH):a},$CLJS.JO,new $CLJS.n(null,6,[$CLJS.FR,function xI(a){if($CLJS.p($CLJS.yh.h($CLJS.sm,$CLJS.mm)(a)))return cH(a);if($CLJS.p(nH(zY,a))){a=$CLJS.y(a);$CLJS.z(a);var c=$CLJS.C(a);a=$CLJS.z(c);c=$CLJS.C(c);return $CLJS.uf.h(new $CLJS.P(null,2,5,$CLJS.Q,[zY,xI.g?xI.g(a):xI.call(null,a)],null),c)}return $CLJS.p($CLJS.p(mH(a))?wI($CLJS.Mc(a)):null)?$CLJS.Ah.h(xI,a):oH.h?oH.h(a,
sY):oH.call(null,a,sY)},$CLJS.FT,function(a){return $CLJS.uf.h($CLJS.ie,function(){return function d(c){return new $CLJS.Ld(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.ad(e)){var f=$CLJS.Rb(e),g=$CLJS.D(f),l=$CLJS.Od(g);a:for(var k=0;;)if(k<g){var m=$CLJS.Pc(f,k),r=$CLJS.I(m,0,null);m=$CLJS.I(m,1,null);r=new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.gD(r),oH.h?oH.h(m,sY):oH.call(null,m,sY)],null);l.add(r);k+=1}else{f=!0;break a}return f?$CLJS.Rd($CLJS.Td(l),d($CLJS.Sb(e))):$CLJS.Rd($CLJS.Td(l),
null)}f=$CLJS.z(e);l=$CLJS.I(f,0,null);f=$CLJS.I(f,1,null);return $CLJS.Jd(new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.gD(l),oH.h?oH.h(f,sY):oH.call(null,f,sY)],null),d($CLJS.qc(e)))}return null}},null)}(a)}())},$CLJS.jW,function(a){return $CLJS.Ue(function(){return function d(c){return new $CLJS.Ld(null,function(){for(;;){var e=$CLJS.y(c);if(e){if($CLJS.ad(e)){var f=$CLJS.Rb(e),g=$CLJS.D(f),l=$CLJS.Od(g);a:for(var k=0;;)if(k<g){var m=$CLJS.Pc(f,k);m=$CLJS.p(mH(m))?qI.g(m):$CLJS.Hd(qI.g($CLJS.Hd(m)));l.add(m);
k+=1}else{f=!0;break a}return f?$CLJS.Rd($CLJS.Td(l),d($CLJS.Sb(e))):$CLJS.Rd($CLJS.Td(l),null)}l=$CLJS.z(e);return $CLJS.Jd($CLJS.p(mH(l))?qI.g(l):$CLJS.Hd(qI.g($CLJS.Hd(l))),d($CLJS.qc(e)))}return null}},null)}(a)}())},$CLJS.KU,function(a){a=dH(a);a=$CLJS.je(a);var b=$CLJS.K.h(a,$CLJS.QT);if($CLJS.p(b))return a=$CLJS.Oo(a,new $CLJS.n(null,1,[$CLJS.QT,$CLJS.JO],null)),b=new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.QT],null),a=oH.h?oH.h(a,b):oH.call(null,a,b),$CLJS.Oo(a,new $CLJS.n(null,1,[$CLJS.JO,$CLJS.QT],
null));b=new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.JO],null);return oH.h?oH.h(a,b):oH.call(null,a,b)},$CLJS.HR,new $CLJS.n(null,1,[wY,wH],null),$CLJS.RP,new $CLJS.n(null,1,[wY,function(a){a=oH.h?oH.h(a,$CLJS.JO):oH.call(null,a,$CLJS.JO);var b=$CLJS.je(a),c=$CLJS.K.h(b,$CLJS.PW),d=$CLJS.K.h(b,$CLJS.UO);a=$CLJS.K.h(b,$CLJS.aR);b=$CLJS.p(c)?$CLJS.BD.j(b,$CLJS.PW,cH):b;d=$CLJS.p($CLJS.yh.h($CLJS.sm,$CLJS.mm)(d))?$CLJS.BD.j(b,$CLJS.UO,cH):b;return $CLJS.p(a)?$CLJS.BD.j(d,$CLJS.aR,$CLJS.gD):d}],null)],null),
$CLJS.sI,new $CLJS.n(null,1,[$CLJS.RQ,$CLJS.xd],null),$CLJS.DP,new $CLJS.n(null,1,[wY,function(a){var b=$CLJS.je(a),c=$CLJS.K.h(b,$CLJS.oj),d=$CLJS.K.h(b,$CLJS.ZW),e=$CLJS.K.h(b,$CLJS.bj);a=$CLJS.K.h(b,AY);b=$CLJS.p(e)?$CLJS.BD.j(b,$CLJS.bj,$CLJS.gD):b;c=$CLJS.p(c)?$CLJS.BD.j(b,$CLJS.oj,cH):b;d=$CLJS.p(d)?$CLJS.BD.j(c,$CLJS.ZW,function(f){return oH.h?oH.h(f,sY):oH.call(null,f,sY)}):c;d=$CLJS.p(a)?UH.j(d,new $CLJS.P(null,2,5,$CLJS.Q,[AY,MY],null),function(f){return oH.h?oH.h(f,sY):oH.call(null,f,sY)}):
d;return $CLJS.p(a)?UH.j(d,new $CLJS.P(null,2,5,$CLJS.Q,[AY,xY],null),function(f){return oH.h?oH.h(f,sY):oH.call(null,f,sY)}):d}],null),$CLJS.AP,function(a){return null==a?null:cH(a)},$CLJS.HR,new $CLJS.n(null,1,[wY,wH],null),JY,cH],null),oH=function oH(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return oH.o(arguments[0],1<c.length?new $CLJS.lc(c.slice(1),0,null):null)};
oH.o=function(a,b){b=$CLJS.I(b,0,null);var c=b instanceof $CLJS.M?new $CLJS.P(null,1,5,$CLJS.Q,[b],null):$CLJS.Ue(b);b=$CLJS.y(c)?$CLJS.dv(yI,c):null;try{return $CLJS.om(b)?b.g?b.g(a):b.call(null,a):$CLJS.Yc(a)?a:$CLJS.Xc(a)?$CLJS.uf.h($CLJS.ie,function(){return function g(f){return new $CLJS.Ld(null,function(){for(;;){var l=$CLJS.y(f);if(l){if($CLJS.ad(l)){var k=$CLJS.Rb(l),m=$CLJS.D(k),r=$CLJS.Od(m);a:for(var v=0;;)if(v<m){var w=$CLJS.Pc(k,v),x=$CLJS.I(w,0,null);w=$CLJS.I(w,1,null);x=cH(x);x=new $CLJS.P(null,
2,5,$CLJS.Q,[x,oH.o(w,$CLJS.G([$CLJS.Gd.h($CLJS.Ue(c),x)]))],null);r.add(x);v+=1}else{k=!0;break a}return k?$CLJS.Rd($CLJS.Td(r),g($CLJS.Sb(l))):$CLJS.Rd($CLJS.Td(r),null)}k=$CLJS.z(l);r=$CLJS.I(k,0,null);k=$CLJS.I(k,1,null);r=cH(r);return $CLJS.Jd(new $CLJS.P(null,2,5,$CLJS.Q,[r,oH.o(k,$CLJS.G([$CLJS.Gd.h($CLJS.Ue(c),r)]))],null),g($CLJS.qc(l)))}return null}},null)}(a)}()):$CLJS.p(mH(a))?qI.g(a):$CLJS.Wc(a)?$CLJS.Ah.h(function(e){return oH.o(e,$CLJS.G([$CLJS.Gd.h($CLJS.Ue(c),wY)]))},a):a}catch(e){if(e instanceof
Error){var d=e;throw $CLJS.Io($CLJS.eD("Error normalizing form: {0}",$CLJS.G([XG(d)])),new $CLJS.n(null,3,[DY,a,$CLJS.Vj,c,LY,b],null),d);}throw e;}};oH.J=1;oH.I=function(a){var b=$CLJS.z(a);a=$CLJS.C(a);return this.o(b,a)};
var yH=function(){var a=$CLJS.vh.g($CLJS.ie),b=$CLJS.vh.g($CLJS.ie),c=$CLJS.vh.g($CLJS.ie),d=$CLJS.vh.g($CLJS.ie),e=$CLJS.K.j($CLJS.ie,$CLJS.kj,$CLJS.Th.v?$CLJS.Th.v():$CLJS.Th.call(null));return new $CLJS.NC($CLJS.Fg.h("metabase.mbql.normalize","canonicalize-mbql-clause"),function(f){return $CLJS.p(mH(f))?$CLJS.z(f):null},e,a,b,c,d)}();yH.ub(null,$CLJS.mh,function(a){return a});
yH.ub(null,$CLJS.aT,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);if($CLJS.p(nH($CLJS.aT,b))){$CLJS.I(b,0,null);var c=$CLJS.I(b,1,null);b=$CLJS.I(b,2,null);return yH.g(new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,c,$CLJS.ke($CLJS.vk.o($CLJS.G([b,a])))],null))}return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,b,$CLJS.ke(a)],null)});yH.ub(null,CY,function(a){$CLJS.I(a,0,null);a=$CLJS.I(a,1,null);return $CLJS.p(mH(a))?yH.g(a):new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,a,null],null)});
yH.ub(null,IY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,b,new $CLJS.n(null,1,[$CLJS.fU,a],null)],null)});yH.ub(null,NY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);var c=zH(b);$CLJS.I(c,0,null);b=$CLJS.I(c,1,null);$CLJS.I(c,2,null);c=zH(a);$CLJS.I(c,0,null);a=$CLJS.I(c,1,null);c=$CLJS.I(c,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,a,$CLJS.Cg.j(c,$CLJS.UP,b)],null)});
yH.ub(null,OY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);a=zH(a);return $CLJS.fe.O($CLJS.GD,a,$CLJS.Cg,$CLJS.G([$CLJS.ES,b]))});
yH.ub(null,GY,function(a){var b=$CLJS.D(a);switch(b){case 3:$CLJS.I(a,0,null);b=$CLJS.I(a,1,null);var c=$CLJS.I(a,2,null);a=zH(b);b=c;$CLJS.I(a,0,null);$CLJS.I(a,1,null);c=$CLJS.I(a,2,null);c=$CLJS.je(c);c=$CLJS.K.h(c,$CLJS.fU);return $CLJS.La(c)||$CLJS.Ez.h(c,b)?$CLJS.fe.O($CLJS.GD,a,$CLJS.Cg,$CLJS.G([$CLJS.JT,b])):a;case 4:return $CLJS.I(a,0,null),b=$CLJS.I(a,1,null),$CLJS.I(a,2,null),c=$CLJS.I(a,3,null),yH.g(new $CLJS.P(null,3,5,$CLJS.Q,[GY,b,c],null));default:throw Error(["No matching clause: ",
$CLJS.q.g(b)].join(""));}});yH.ub(null,FY,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null),c=$CLJS.I(a,2,null),d=$CLJS.I(a,3,null);a=$CLJS.I(a,4,null);var e=zH(b);$CLJS.I(e,0,null);b=$CLJS.I(e,1,null);e=$CLJS.I(e,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.aT,b,$CLJS.Cg.j(e,$CLJS.WV,$CLJS.vk.o($CLJS.G([new $CLJS.n(null,1,[$CLJS.PW,c],null),$CLJS.p(d)?$CLJS.he([c,d]):null,a])))],null)});
for(var UY=$CLJS.y(new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.Jh,$CLJS.Zi,$CLJS.mj],null)),VY=null,WY=0,XY=0;;)if(XY<WY){var YY=VY.ja(null,XY);yH.ub(null,YY,function(){return function(a){return AH(a)}}(UY,VY,WY,XY,YY));XY+=1}else{var ZY=$CLJS.y(UY);if(ZY){var $Y=ZY;if($CLJS.ad($Y)){var aZ=$CLJS.Rb($Y),bZ=$CLJS.Sb($Y),cZ=aZ,dZ=$CLJS.D(aZ);UY=bZ;VY=cZ;WY=dZ}else{var eZ=$CLJS.z($Y);yH.ub(null,eZ,function(){return function(a){return AH(a)}}(UY,VY,WY,XY,eZ,$Y,ZY));UY=$CLJS.C($Y);VY=null;WY=0}XY=0}else break}
yH.ub(null,$CLJS.ZP,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.C(a);a=$CLJS.z(b);var c=$CLJS.C(b);b=$CLJS.z(c);c=$CLJS.C(c);return $CLJS.uf.h(new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.ZP,zH(a),zH(b)],null),c)});yH.ub(null,$CLJS.IU,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.C(a);a=$CLJS.z(b);b=$CLJS.C(b);var c=zH(a);a=$CLJS.p($CLJS.hD($CLJS.aT,a))?$CLJS.GD.o(c,$CLJS.sh,$CLJS.G([$CLJS.JT])):c;return $CLJS.uf.h(new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.IU,a],null),b)});
for(var fZ=$CLJS.y(new $CLJS.P(null,15,5,$CLJS.Q,[$CLJS.RR,$CLJS.vU,$CLJS.US,$CLJS.UR,$CLJS.bk,$CLJS.iV,$CLJS.ck,$CLJS.ok,$CLJS.ek,$CLJS.nk,$CLJS.tP,$CLJS.iQ,$CLJS.ZO,$CLJS.iR,$CLJS.sP],null)),gZ=null,hZ=0,iZ=0;;)if(iZ<hZ){var jZ=gZ.ja(null,iZ);yH.ub(null,jZ,function(){return function(a){return BH(a)}}(fZ,gZ,hZ,iZ,jZ));iZ+=1}else{var kZ=$CLJS.y(fZ);if(kZ){var lZ=kZ;if($CLJS.ad(lZ)){var mZ=$CLJS.Rb(lZ),nZ=$CLJS.Sb(lZ),oZ=mZ,pZ=$CLJS.D(mZ);fZ=nZ;gZ=oZ;hZ=pZ}else{var qZ=$CLJS.z(lZ);yH.ub(null,qZ,function(){return function(a){return BH(a)}}(fZ,
gZ,hZ,iZ,qZ,lZ,kZ));fZ=$CLJS.C(lZ);gZ=null;hZ=0}iZ=0}else break}yH.ub(null,KY,function(){return null});yH.ub(null,$CLJS.yO,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.yO,yH.g(b),a],null)});
yH.ub(null,zY,function(a){a=$CLJS.y(a);$CLJS.z(a);a=$CLJS.C(a);var b=$CLJS.z(a),c=$CLJS.C(a);a=$CLJS.z(c);var d=$CLJS.C(c);c=yH.g;var e=$CLJS.Q;b=yH.g(b);d=$CLJS.I(d,0,null);d=$CLJS.je(d);a=!1===$CLJS.K.h(d,HY)?new $CLJS.n(null,1,[$CLJS.S,a],null):new $CLJS.n(null,1,[$CLJS.TP,a],null);return c.call(yH,new $CLJS.P(null,3,5,e,[$CLJS.yO,b,a],null))});
for(var rZ=$CLJS.y(new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.FF,$CLJS.eT],null)),sZ=null,tZ=0,uZ=0;;)if(uZ<tZ){var vZ=sZ.ja(null,uZ);yH.ub(null,vZ,function(){return function(a){return CH(a)}}(rZ,sZ,tZ,uZ,vZ));uZ+=1}else{var wZ=$CLJS.y(rZ);if(wZ){var xZ=wZ;if($CLJS.ad(xZ)){var yZ=$CLJS.Rb(xZ),zZ=$CLJS.Sb(xZ),AZ=yZ,BZ=$CLJS.D(yZ);rZ=zZ;sZ=AZ;tZ=BZ}else{var CZ=$CLJS.z(xZ);yH.ub(null,CZ,function(){return function(a){return CH(a)}}(rZ,sZ,tZ,uZ,CZ,xZ,wZ));rZ=$CLJS.C(xZ);sZ=null;tZ=0}uZ=0}else break}
for(var DZ=$CLJS.y(new $CLJS.P(null,9,5,$CLJS.Q,[$CLJS.gS,$CLJS.oW,$CLJS.vP,$CLJS.eV,$CLJS.OU,$CLJS.Qi,$CLJS.Tj,$CLJS.TU,$CLJS.KP],null)),EZ=null,FZ=0,GZ=0;;)if(GZ<FZ){var HZ=EZ.ja(null,GZ);yH.ub(null,HZ,function(){return function(a){return DH(a)}}(DZ,EZ,FZ,GZ,HZ));GZ+=1}else{var IZ=$CLJS.y(DZ);if(IZ){var JZ=IZ;if($CLJS.ad(JZ)){var KZ=$CLJS.Rb(JZ),LZ=$CLJS.Sb(JZ),MZ=KZ,NZ=$CLJS.D(KZ);DZ=LZ;EZ=MZ;FZ=NZ}else{var OZ=$CLJS.z(JZ);yH.ub(null,OZ,function(){return function(a){return DH(a)}}(DZ,EZ,FZ,GZ,OZ,
JZ,IZ));DZ=$CLJS.C(JZ);EZ=null;FZ=0}GZ=0}else break}yH.ub(null,$CLJS.bR,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.bR,zH(b),a],null)});
for(var PZ=$CLJS.y(new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.LT,$CLJS.bU],null)),QZ=null,RZ=0,SZ=0;;)if(SZ<RZ){var TZ=QZ.ja(null,SZ);yH.ub(null,TZ,function(){return function(a){return EH(a)}}(PZ,QZ,RZ,SZ,TZ));SZ+=1}else{var UZ=$CLJS.y(PZ);if(UZ){var VZ=UZ;if($CLJS.ad(VZ)){var WZ=$CLJS.Rb(VZ),XZ=$CLJS.Sb(VZ),YZ=WZ,ZZ=$CLJS.D(WZ);PZ=XZ;QZ=YZ;RZ=ZZ}else{var $Z=$CLJS.z(VZ);yH.ub(null,$Z,function(){return function(a){return EH(a)}}(PZ,QZ,RZ,SZ,$Z,VZ,UZ));PZ=$CLJS.C(VZ);QZ=null;RZ=0}SZ=0}else break}
yH.ub(null,$CLJS.TV,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.TV,yH.g(b),yH.g(a)],null)});
yH.ub(null,$CLJS.hQ,function(a){$CLJS.I(a,0,null);var b=$CLJS.I(a,1,null);a=$CLJS.I(a,2,null);return $CLJS.p(a)?$CLJS.Gd.h(yH.g(new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.hQ,b],null)),oH.o(a,$CLJS.G([sY]))):new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.hQ,$CLJS.Ue(function(){return function e(d){return new $CLJS.Ld(null,function(){for(;;){var f=$CLJS.y(d);if(f){if($CLJS.ad(f)){var g=$CLJS.Rb(f),l=$CLJS.D(g),k=$CLJS.Od(l);a:for(var m=0;;)if(m<l){var r=$CLJS.Pc(g,m),v=$CLJS.I(r,0,null);r=$CLJS.I(r,1,null);v=new $CLJS.P(null,
2,5,$CLJS.Q,[yH.g(v),yH.g(r)],null);k.add(v);m+=1}else{g=!0;break a}return g?$CLJS.Rd($CLJS.Td(k),e($CLJS.Sb(f))):$CLJS.Rd($CLJS.Td(k),null)}g=$CLJS.z(f);k=$CLJS.I(g,0,null);g=$CLJS.I(g,1,null);return $CLJS.Jd(new $CLJS.P(null,2,5,$CLJS.Q,[yH.g(k),yH.g(g)],null),e($CLJS.qc(f)))}return null}},null)}(b)}())],null)});
yH.ub(null,$CLJS.kO,function(a){a=$CLJS.y(a);$CLJS.z(a);var b=$CLJS.C(a);a=$CLJS.z(b);var c=$CLJS.C(b);b=$CLJS.z(c);c=$CLJS.C(c);return $CLJS.uf.h(new $CLJS.P(null,3,5,$CLJS.Q,[$CLJS.kO,yH.g(a),$CLJS.E.h(0,b)?1:yH.g(b)],null),$CLJS.xg.h(yH,c))});
var HH=function HH(a){return function f(d,e){try{if($CLJS.p(function(){var w=$CLJS.bD($CLJS.Hh);return w.g?w.g(e):w.call(null,e)}()))return f(d,$CLJS.Ue(e));throw $CLJS.Z;}catch(w){if(w instanceof Error)if(d=w,d===$CLJS.Z)try{if($CLJS.p(function(){var x=$CLJS.bD($CLJS.sm);return x.g?x.g(e):x.call(null,e)}()))return new $CLJS.P(null,1,5,$CLJS.Q,[new $CLJS.P(null,1,5,$CLJS.Q,[e],null)],null);throw $CLJS.Z;}catch(x){if(x instanceof Error)if(d=x,d===$CLJS.Z)try{if($CLJS.Zc(e)&&2<=$CLJS.D(e))try{var g=
$CLJS.RC(e,0,2);if($CLJS.Zc(g)&&2===$CLJS.D(g))try{var l=$CLJS.F(g,0);if($CLJS.p($CLJS.xh.h($CLJS.sm,$CLJS.ue(new $CLJS.R(null,new $CLJS.n(null,5,[$CLJS.hk,null,$CLJS.fW,null,$CLJS.aW,null,$CLJS.gk,null,zY,null],null),null)))(l)))try{var k=$CLJS.F(g,1);if($CLJS.p(wI(k)))return $CLJS.Ue($CLJS.ud($CLJS.th,$CLJS.xg.h(HH,a)));throw $CLJS.Z;}catch(A){if(A instanceof Error){var m=A;if(m===$CLJS.Z)throw $CLJS.Z;throw m;}throw A;}else throw $CLJS.Z;}catch(A){if(A instanceof Error){m=A;if(m===$CLJS.Z)throw $CLJS.Z;
throw m;}throw A;}else throw $CLJS.Z;}catch(A){if(A instanceof Error){m=A;if(m===$CLJS.Z)throw $CLJS.Z;throw m;}throw A;}else throw $CLJS.Z;}catch(A){if(A instanceof Error)if(m=A,m===$CLJS.Z)try{if($CLJS.Zc(e)&&1<=$CLJS.D(e))try{var r=$CLJS.RC(e,0,1);if($CLJS.Zc(r)&&1===$CLJS.D(r))try{if($CLJS.F(r,0)instanceof $CLJS.M)return new $CLJS.P(null,1,5,$CLJS.Q,[e],null);throw $CLJS.Z;}catch(H){if(H instanceof Error){var v=H;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof
Error){v=H;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof Error){v=H;if(v===$CLJS.Z)return e;throw v;}throw H;}else throw m;else throw A;}else throw d;else throw x;}else throw d;else throw w;}}($CLJS.Te,a)},GJ=function GJ(a){return function f(d,e){try{var g=$CLJS.bD($CLJS.Hh);var l=g.g?g.g(e):g.call(null,e);if($CLJS.p(l))return f(d,$CLJS.Ue(e));throw $CLJS.Z;}catch(A){if(A instanceof Error)if(l=A,l===$CLJS.Z)try{if($CLJS.Zc(e)&&2===$CLJS.D(e))try{var k=
$CLJS.F(e,1);if($CLJS.O(k,$CLJS.rS)){var m=$CLJS.F(e,0);return f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.rS,m],null))}throw $CLJS.Z;}catch(H){if(H instanceof Error)if(l=H,l===$CLJS.Z)try{k=$CLJS.F(e,1);if($CLJS.O(k,$CLJS.MR))return m=$CLJS.F(e,0),f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.MR,m],null));throw $CLJS.Z;}catch(N){if(N instanceof Error){var r=N;if(r===$CLJS.Z)try{k=$CLJS.F(e,1);if($CLJS.O(k,yY))return m=$CLJS.F(e,0),f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.rS,m],null));throw $CLJS.Z;}catch(Y){if(Y instanceof
Error)if(l=Y,l===$CLJS.Z)try{k=$CLJS.F(e,1);if($CLJS.O(k,EY))return m=$CLJS.F(e,0),f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.MR,m],null));throw $CLJS.Z;}catch(la){if(la instanceof Error)if(k=la,k===$CLJS.Z)try{var v=$CLJS.F(e,0);if($CLJS.O(v,yY))return m=$CLJS.F(e,1),f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.rS,m],null));throw $CLJS.Z;}catch(va){if(va instanceof Error)if(k=va,k===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.O(v,EY))return m=$CLJS.F(e,1),f(d,new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.MR,m],null));throw $CLJS.Z;
}catch(Ja){if(Ja instanceof Error)if(k=Ja,k===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.O(v,$CLJS.rS))return m=$CLJS.F(e,1),new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.rS,zH(m)],null);throw $CLJS.Z;}catch(Ea){if(Ea instanceof Error)if(k=Ea,k===$CLJS.Z)try{v=$CLJS.F(e,0);if($CLJS.O(v,$CLJS.MR))return m=$CLJS.F(e,1),new $CLJS.P(null,2,5,$CLJS.Q,[$CLJS.MR,zH(m)],null);throw $CLJS.Z;}catch(db){if(db instanceof Error){m=db;if(m===$CLJS.Z)throw $CLJS.Z;throw m;}throw db;}else throw k;else throw Ea;}else throw k;else throw Ja;
}else throw k;else throw va;}else throw k;else throw la;}else throw l;else throw Y;}else throw r;}else throw N;}else throw l;else throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof Error)if(l=H,l===$CLJS.Z)try{if($CLJS.Zc(e)&&0<=$CLJS.D(e))try{var w=$CLJS.RC(e,0,0);if($CLJS.Zc(w)&&0===$CLJS.D(w))try{var x=$CLJS.SC(e,0);if($CLJS.E.h(x,a))return $CLJS.Ue($CLJS.Ki.g($CLJS.xg.h(GJ,a)));throw $CLJS.Z;}catch(N){if(N instanceof Error){r=N;if(r===$CLJS.Z)throw $CLJS.Z;throw r;}throw N;}else throw $CLJS.Z;
}catch(N){if(N instanceof Error){r=N;if(r===$CLJS.Z)throw $CLJS.Z;throw r;}throw N;}else throw $CLJS.Z;}catch(N){if(N instanceof Error){r=N;if(r===$CLJS.Z)return $CLJS.dD(f,d,e);throw r;}throw N;}else throw l;else throw H;}else throw l;else throw A;}}($CLJS.Te,a)},PH=$CLJS.Li.h(aH,function(a){var b=RH($CLJS.FR.g(a))?$CLJS.BD.j(a,$CLJS.FR,IH):a;b=RH($CLJS.tR.g(a))?$CLJS.BD.j(b,$CLJS.tR,JH):b;b=RH($CLJS.UO.g(a))?$CLJS.BD.j(b,$CLJS.UO,$CLJS.wi($CLJS.Ah,xH)):b;b=RH($CLJS.jW.g(a))?$CLJS.BD.j(b,$CLJS.jW,
GJ):b;return RH($CLJS.KU.g(a))?$CLJS.BD.j(b,$CLJS.KU,QH):b}),HJ=new $CLJS.n(null,3,[$CLJS.QT,$CLJS.xd,$CLJS.JO,new $CLJS.n(null,2,[$CLJS.KU,function(a){a=$CLJS.je(a);var b=$CLJS.K.h(a,$CLJS.QT);if($CLJS.p(b))return a=$CLJS.Oo(a,new $CLJS.n(null,1,[$CLJS.QT,$CLJS.JO],null)),b=new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.QT],null),a=XH.h?XH.h(a,b):XH.call(null,a,b),$CLJS.Oo(a,new $CLJS.n(null,1,[$CLJS.JO,$CLJS.QT],null));b=new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.JO],null);return XH.h?XH.h(a,b):XH.call(null,a,b)},
$CLJS.RP,new $CLJS.n(null,1,[wY,function(a){var b=new $CLJS.P(null,1,5,$CLJS.Q,[$CLJS.JO],null);return XH.h?XH.h(a,b):XH.call(null,a,b)}],null)],null),JY,$CLJS.xd],null),XH=function XH(a){switch(arguments.length){case 1:return XH.g(arguments[0]);case 2:return XH.h(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",$CLJS.q.g(arguments.length)].join(""));}};XH.g=function(a){return XH.h(a,$CLJS.Te)};
XH.h=function(a,b){try{var c=$CLJS.y(b)?$CLJS.dv(HJ,b):null;return $CLJS.om(c)?c.g?c.g(a):c.call(null,a):$CLJS.Yc(a)?a:$CLJS.Xc(a)?YH(a,b):$CLJS.Wc(a)?$H(a,b):a}catch(d){if(d instanceof Error)throw $CLJS.Io("Error removing empty clauses from form.",new $CLJS.n(null,2,[DY,a,$CLJS.Vj,b],null),d);throw d;}};XH.J=2;
$CLJS.IJ=function(){var a=$CLJS.Li.o(XH,WH,TH,$CLJS.G([oH]));return function(b){try{return a(b)}catch(d){if(d instanceof Error){var c=d;throw $CLJS.Io($CLJS.eD("Error normalizing query: {0}",$CLJS.G([XG(c)])),new $CLJS.n(null,1,[$CLJS.JO,b],null),c);}throw d;}}}();