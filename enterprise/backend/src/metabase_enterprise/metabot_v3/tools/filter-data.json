{
  "name": "filter-data",
  "description": "This tool filters data based on specified conditions applied to particular fields. It is ideal for narrowing down data to meet specific criteria by using various comparison operators such as less than, greater than, equals, contains, and more. Ensure that each 'column_id' corresponds to a valid field in your dataset and that the chosen 'operator' is compatible with the field's data type to avoid errors. Note that this tool solely focuses on filtering data and does not perform any aggregation or modification. The filtered results will be displayed to the user in the Metabase query editor. Note that this will fire a fresh query - the previous query state will be lost. In case you want to keep parts of the previous state, you need to include them in the parameters.",
  "parameters": {
    "type": "object",
    "properties": {
      "filters": {
        "type": "array",
        "items": {
          "anyOf": [
            {
              "type": "object",
              "description": "Filter query results by a string field and value. Note that strings could have both null and empty values.",
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": [
                    "add_string_filter"
                  ]
                },
                "column_id": {
                  "type": "integer",
                  "description": "The ID of the string column to apply the filter to."
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "=",
                    "!=",
                    "contains",
                    "does-not-contain",
                    "starts-with",
                    "ends-with",
                    "is-empty",
                    "is-not-empty"
                  ],
                  "description": "The operator to use for filtering string values. Use 'is-empty' and 'is-not-empty' for filtering null and empty strings. If only filtering against null values, '!=' or '=' with a null value should be used."
                },
                "value": {
                  "type": "string",
                  "description": "The string to compare against the field's value. This value is case-insensitive. For 'is-empty' and 'is-not-empty' operators, this value should be set to an empty string."
                }
              },
              "required": [
                "operation",
                "column_id",
                "operator",
                "value"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "description": "Filter query results by a numeric field and value.",
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": [
                    "add_numeric_filter"
                  ]
                },
                "column_id": {
                  "type": "integer",
                  "description": "The ID of the numeric column to apply the filter to."
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "<",
                    "<=",
                    ">",
                    ">=",
                    "=",
                    "!="
                  ],
                  "description": "The operator to use for filtering numeric values."
                },
                "value": {
                  "type": "number",
                  "description": "The number to compare against the field's value."
                }
              },
              "required": [
                "operation",
                "column_id",
                "operator",
                "value"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "description": "Filter query results by a boolean field and value.",
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": [
                    "add_boolean_filter"
                  ]
                },
                "column_id": {
                  "type": "integer",
                  "description": "The ID of the boolean column to apply the filter to."
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "=",
                    "!="
                  ],
                  "description": "The operator to use for filtering boolean values."
                },
                "value": {
                  "type": "boolean",
                  "description": "The boolean value to compare against the field's value."
                }
              },
              "required": [
                "operation",
                "column_id",
                "operator",
                "value"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "description": "Filter query results by exact datetime/date field and value.",
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": [
                    "add_exact_date_filter"
                  ]
                },
                "column_id": {
                  "type": "integer",
                  "description": "The ID of the date column to apply the filter to."
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "<",
                    "<=",
                    ">",
                    ">=",
                    "=",
                    "!="
                  ],
                  "description": "The operator to use for filtering date values."
                },
                "value": {
                  "type": "string",
                  "description": "The date to compare against the field's value. The date must be in the format 'YYYY-MM-DD' for dates and 'YYYY-MM-DD HH:MM:SS' for datetimes."
                }
              },
              "required": [
                "operation",
                "column_id",
                "operator",
                "value"
              ],
              "additionalProperties": false
            },
            {
              "type": "object",
              "description": "Filter query results by date part of datetime/date field and value like year, month, day of week, day of year, week of year, hour, minute, second, etc.",
              "properties": {
                "operation": {
                  "type": "string",
                  "enum": [
                    "add_date_part_filter"
                  ]
                },
                "column_id": {
                  "type": "integer",
                  "description": "The ID of the date column to apply the filter to."
                },
                "date_part": {
                  "type": "string",
                  "description": "The date part to filter on.",
                  "enum": [
                    "year",
                    "quarter",
                    "month",
                    "day",
                    "hour",
                    "minute",
                    "second",
                    "day-of-week"
                  ]
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "<",
                    "<=",
                    ">",
                    ">=",
                    "=",
                    "!="
                  ],
                  "description": "The operator to use for filtering date part values."
                },
                "value": {
                  "type": ["number"],
                  "description": "The date part value to compare against the field's value. Use integers (1-12 for months, 1-7 for weekdays starting Monday)"
                }
              },
              "required": [
                "operation",
                "column_id",
                "date_part",
                "operator",
                "value"
              ],
              "additionalProperties": false
            }
          ]
        }
      }
    },
    "required": [
      "filters"
    ],
    "additionalProperties": false
  }
}
