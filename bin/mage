#! /usr/bin/env bb

(ns mage
  (:require
   [babashka.tasks :refer [shell]]
   [clojure.string :as str]
   [mage.color :as c]))

(defn -main [& _]
  (if (or (nil? *command-line-args*) ;; forgot to pass args
          ;; trying to get help
          (= *command-line-args* ["-h"])
          (= *command-line-args* ["--help"]))
    (do
      (print (slurp "./mage/resource.txt"))
      (flush)
      (println (c/bold " ✨ Metabase Automation Genius Engine ✨"))
      (println "")
      (shell "bb tasks"))
    (shell (str "bb " (str/join " " *command-line-args*)))))

(when (= *file* (System/getProperty "babashka.file"))
  (-main))
