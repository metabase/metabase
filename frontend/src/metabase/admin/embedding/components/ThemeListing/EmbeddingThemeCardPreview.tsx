import { useCallback, useMemo } from "react";

import {
  DEFAULT_SDK_FONT_SIZE,
  type MetabaseColor,
  type MetabaseTheme,
} from "metabase/embedding-sdk/theme";
import { getSizeInPx } from "metabase/visualizations/shared/utils/size-in-px";

import { useDefaultEmbeddingTheme } from "../../hooks/use-default-embedding-theme";

// TODO(EMB-942): add embedding theme preview placeholder card
export const EmbeddingThemeCardPreview = ({
  theme,
}: {
  theme: MetabaseTheme;
}) => {
  const { colors } = theme ?? {};
  const defaultTheme = useDefaultEmbeddingTheme();

  const colorOf = (key: Exclude<MetabaseColor, "charts">) =>
    colors?.[key] ?? defaultTheme.colors?.[key];

  // Get preview sizes.
  const emToPx = useCallback(
    (emValue: number) => {
      const baseFontSize = getSizeInPx(theme.fontSize) ?? DEFAULT_SDK_FONT_SIZE;

      return getSizeInPx(`${emValue}em`, baseFontSize);
    },
    [theme.fontSize],
  );

  const h1FontSize = useMemo(() => emToPx(1.714), [emToPx]);
  const h2FontSize = useMemo(() => emToPx(1.143), [emToPx]);

  return (
    <svg viewBox="0 0 251 251" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g clipPath="url(#clip0_17128_6556)">
        <mask id="path-1-inside-1_17128_6556" fill="white">
          <path d="M0 0H251V251H0V0Z" />
        </mask>
        <path d="M0 0H251V251H0V0Z" fill={colorOf("background-secondary")} />
        <text
          x="28"
          y="48"
          fill={colorOf("text-primary")}
          fontSize={h1FontSize}
          fontWeight="600"
        >
          {"Abc"}
        </text>
        <rect x="28" y="69" width="435" height="269" rx="6" fill="white" />
        <rect
          x="28.5"
          y="69.5"
          width="434"
          height="268"
          rx="5.5"
          stroke="#071722"
          strokeOpacity="0.14"
        />
        <line x1="97" y1="142.5" x2="437" y2="142.5" stroke="#EEECEC" />
        <line x1="97" y1="188.5" x2="437" y2="188.5" stroke="#EEECEC" />
        <line x1="97" y1="235.5" x2="437" y2="235.5" stroke="#EEECEC" />
        <path
          d="M60.8972 141.73C60.9532 141.338 61.0612 140.992 61.2212 140.692C61.3812 140.388 61.5832 140.134 61.8272 139.93C62.0752 139.726 62.3572 139.572 62.6732 139.468C62.9932 139.36 63.3372 139.306 63.7052 139.306C64.0692 139.306 64.4052 139.358 64.7132 139.462C65.0212 139.566 65.2852 139.714 65.5052 139.906C65.7292 140.098 65.9032 140.33 66.0272 140.602C66.1512 140.874 66.2132 141.176 66.2132 141.508C66.2132 141.78 66.1772 142.024 66.1052 142.24C66.0372 142.452 65.9372 142.638 65.8052 142.798C65.6772 142.958 65.5212 143.094 65.3372 143.206C65.1532 143.318 64.9472 143.41 64.7192 143.482C65.2792 143.626 65.6992 143.874 65.9792 144.226C66.2632 144.574 66.4052 145.01 66.4052 145.534C66.4052 145.93 66.3292 146.286 66.1772 146.602C66.0292 146.918 65.8252 147.188 65.5652 147.412C65.3052 147.632 65.0012 147.802 64.6532 147.922C64.3092 148.038 63.9392 148.096 63.5432 148.096C63.0872 148.096 62.6972 148.04 62.3732 147.928C62.0492 147.812 61.7752 147.654 61.5512 147.454C61.3272 147.254 61.1432 147.018 60.9992 146.746C60.8552 146.47 60.7332 146.172 60.6332 145.852L61.0952 145.66C61.2152 145.608 61.3312 145.594 61.4432 145.618C61.5592 145.642 61.6432 145.708 61.6952 145.816C61.7472 145.928 61.8112 146.062 61.8872 146.218C61.9672 146.374 62.0752 146.524 62.2112 146.668C62.3472 146.812 62.5192 146.934 62.7272 147.034C62.9392 147.134 63.2072 147.184 63.5312 147.184C63.8312 147.184 64.0932 147.136 64.3172 147.04C64.5452 146.94 64.7332 146.812 64.8812 146.656C65.0332 146.5 65.1472 146.326 65.2232 146.134C65.2992 145.942 65.3372 145.752 65.3372 145.564C65.3372 145.332 65.3072 145.12 65.2472 144.928C65.1872 144.736 65.0752 144.57 64.9112 144.43C64.7472 144.29 64.5212 144.18 64.2332 144.1C63.9492 144.02 63.5832 143.98 63.1352 143.98V143.206C63.5032 143.202 63.8152 143.162 64.0712 143.086C64.3312 143.01 64.5412 142.906 64.7012 142.774C64.8652 142.642 64.9832 142.484 65.0552 142.3C65.1312 142.116 65.1692 141.912 65.1692 141.688C65.1692 141.44 65.1292 141.224 65.0492 141.04C64.9732 140.856 64.8672 140.704 64.7312 140.584C64.5952 140.464 64.4332 140.374 64.2452 140.314C64.0612 140.254 63.8612 140.224 63.6452 140.224C63.4292 140.224 63.2272 140.256 63.0392 140.32C62.8552 140.384 62.6912 140.474 62.5472 140.59C62.4072 140.702 62.2892 140.836 62.1932 140.992C62.0972 141.148 62.0292 141.32 61.9892 141.508C61.9372 141.648 61.8712 141.742 61.7912 141.79C61.7152 141.834 61.6032 141.846 61.4552 141.826L60.8972 141.73ZM73.6781 143.704C73.6781 144.456 73.5961 145.108 73.4321 145.66C73.2721 146.208 73.0521 146.662 72.7721 147.022C72.4921 147.382 72.1601 147.65 71.7761 147.826C71.3961 148.002 70.9881 148.09 70.5521 148.09C70.1121 148.09 69.7021 148.002 69.3221 147.826C68.9461 147.65 68.6181 147.382 68.3381 147.022C68.0581 146.662 67.8381 146.208 67.6781 145.66C67.5181 145.108 67.4381 144.456 67.4381 143.704C67.4381 142.952 67.5181 142.3 67.6781 141.748C67.8381 141.196 68.0581 140.74 68.3381 140.38C68.6181 140.016 68.9461 139.746 69.3221 139.57C69.7021 139.394 70.1121 139.306 70.5521 139.306C70.9881 139.306 71.3961 139.394 71.7761 139.57C72.1601 139.746 72.4921 140.016 72.7721 140.38C73.0521 140.74 73.2721 141.196 73.4321 141.748C73.5961 142.3 73.6781 142.952 73.6781 143.704ZM72.5681 143.704C72.5681 143.048 72.5121 142.498 72.4001 142.054C72.2921 141.606 72.1441 141.246 71.9561 140.974C71.7721 140.702 71.5581 140.508 71.3141 140.392C71.0701 140.272 70.8161 140.212 70.5521 140.212C70.2881 140.212 70.0341 140.272 69.7901 140.392C69.5461 140.508 69.3321 140.702 69.1481 140.974C68.9641 141.246 68.8161 141.606 68.7041 142.054C68.5961 142.498 68.5421 143.048 68.5421 143.704C68.5421 144.36 68.5961 144.91 68.7041 145.354C68.8161 145.798 68.9641 146.156 69.1481 146.428C69.3321 146.7 69.5461 146.896 69.7901 147.016C70.0341 147.132 70.2881 147.19 70.5521 147.19C70.8161 147.19 71.0701 147.132 71.3141 147.016C71.5581 146.896 71.7721 146.7 71.9561 146.428C72.1441 146.156 72.2921 145.798 72.4001 145.354C72.5121 144.91 72.5681 144.36 72.5681 143.704ZM80.6391 143.704C80.6391 144.456 80.5571 145.108 80.3931 145.66C80.2331 146.208 80.0131 146.662 79.7331 147.022C79.4531 147.382 79.1211 147.65 78.7371 147.826C78.3571 148.002 77.9491 148.09 77.5131 148.09C77.0731 148.09 76.6631 148.002 76.2831 147.826C75.9071 147.65 75.5791 147.382 75.2991 147.022C75.0191 146.662 74.7991 146.208 74.6391 145.66C74.4791 145.108 74.3991 144.456 74.3991 143.704C74.3991 142.952 74.4791 142.3 74.6391 141.748C74.7991 141.196 75.0191 140.74 75.2991 140.38C75.5791 140.016 75.9071 139.746 76.2831 139.57C76.6631 139.394 77.0731 139.306 77.5131 139.306C77.9491 139.306 78.3571 139.394 78.7371 139.57C79.1211 139.746 79.4531 140.016 79.7331 140.38C80.0131 140.74 80.2331 141.196 80.3931 141.748C80.5571 142.3 80.6391 142.952 80.6391 143.704ZM79.5291 143.704C79.5291 143.048 79.4731 142.498 79.3611 142.054C79.2531 141.606 79.1051 141.246 78.9171 140.974C78.7331 140.702 78.5191 140.508 78.2751 140.392C78.0311 140.272 77.7771 140.212 77.5131 140.212C77.2491 140.212 76.9951 140.272 76.7511 140.392C76.5071 140.508 76.2931 140.702 76.1091 140.974C75.9251 141.246 75.7771 141.606 75.6651 142.054C75.5571 142.498 75.5031 143.048 75.5031 143.704C75.5031 144.36 75.5571 144.91 75.6651 145.354C75.7771 145.798 75.9251 146.156 76.1091 146.428C76.2931 146.7 76.5071 146.896 76.7511 147.016C76.9951 147.132 77.2491 147.19 77.5131 147.19C77.7771 147.19 78.0311 147.132 78.2751 147.016C78.5191 146.896 78.7331 146.7 78.9171 146.428C79.1051 146.156 79.2531 145.798 79.3611 145.354C79.4731 144.91 79.5291 144.36 79.5291 143.704Z"
          fill="#656F76"
        />
        <path
          d="M66.0392 192.986C66.1552 192.986 66.2472 193.02 66.3152 193.088C66.3832 193.156 66.4172 193.244 66.4172 193.352V194H60.6812V193.634C60.6812 193.558 60.6972 193.48 60.7292 193.4C60.7612 193.32 60.8112 193.246 60.8792 193.178L63.6332 190.412C63.8612 190.18 64.0692 189.958 64.2572 189.746C64.4452 189.53 64.6052 189.314 64.7372 189.098C64.8692 188.882 64.9712 188.664 65.0432 188.444C65.1152 188.22 65.1512 187.982 65.1512 187.73C65.1512 187.478 65.1112 187.258 65.0312 187.07C64.9512 186.878 64.8412 186.72 64.7012 186.596C64.5652 186.472 64.4032 186.38 64.2152 186.32C64.0272 186.256 63.8252 186.224 63.6092 186.224C63.3892 186.224 63.1872 186.256 63.0032 186.32C62.8192 186.384 62.6552 186.474 62.5112 186.59C62.3712 186.702 62.2532 186.836 62.1572 186.992C62.0612 187.148 61.9932 187.32 61.9532 187.508C61.9052 187.648 61.8392 187.742 61.7552 187.79C61.6752 187.834 61.5612 187.846 61.4132 187.826L60.8552 187.73C60.9112 187.338 61.0192 186.992 61.1792 186.692C61.3432 186.388 61.5472 186.134 61.7912 185.93C62.0392 185.726 62.3212 185.572 62.6372 185.468C62.9532 185.36 63.2952 185.306 63.6632 185.306C64.0272 185.306 64.3672 185.36 64.6832 185.468C64.9992 185.576 65.2732 185.734 65.5052 185.942C65.7372 186.146 65.9192 186.396 66.0512 186.692C66.1832 186.988 66.2492 187.324 66.2492 187.7C66.2492 188.02 66.2012 188.318 66.1052 188.594C66.0092 188.866 65.8792 189.126 65.7152 189.374C65.5512 189.622 65.3612 189.864 65.1452 190.1C64.9332 190.336 64.7072 190.574 64.4672 190.814L62.1992 193.13C62.3592 193.086 62.5212 193.052 62.6852 193.028C62.8492 193 63.0072 192.986 63.1592 192.986H66.0392ZM73.6781 189.704C73.6781 190.456 73.5961 191.108 73.4321 191.66C73.2721 192.208 73.0521 192.662 72.7721 193.022C72.4921 193.382 72.1601 193.65 71.7761 193.826C71.3961 194.002 70.9881 194.09 70.5521 194.09C70.1121 194.09 69.7021 194.002 69.3221 193.826C68.9461 193.65 68.6181 193.382 68.3381 193.022C68.0581 192.662 67.8381 192.208 67.6781 191.66C67.5181 191.108 67.4381 190.456 67.4381 189.704C67.4381 188.952 67.5181 188.3 67.6781 187.748C67.8381 187.196 68.0581 186.74 68.3381 186.38C68.6181 186.016 68.9461 185.746 69.3221 185.57C69.7021 185.394 70.1121 185.306 70.5521 185.306C70.9881 185.306 71.3961 185.394 71.7761 185.57C72.1601 185.746 72.4921 186.016 72.7721 186.38C73.0521 186.74 73.2721 187.196 73.4321 187.748C73.5961 188.3 73.6781 188.952 73.6781 189.704ZM72.5681 189.704C72.5681 189.048 72.5121 188.498 72.4001 188.054C72.2921 187.606 72.1441 187.246 71.9561 186.974C71.7721 186.702 71.5581 186.508 71.3141 186.392C71.0701 186.272 70.8161 186.212 70.5521 186.212C70.2881 186.212 70.0341 186.272 69.7901 186.392C69.5461 186.508 69.3321 186.702 69.1481 186.974C68.9641 187.246 68.8161 187.606 68.7041 188.054C68.5961 188.498 68.5421 189.048 68.5421 189.704C68.5421 190.36 68.5961 190.91 68.7041 191.354C68.8161 191.798 68.9641 192.156 69.1481 192.428C69.3321 192.7 69.5461 192.896 69.7901 193.016C70.0341 193.132 70.2881 193.19 70.5521 193.19C70.8161 193.19 71.0701 193.132 71.3141 193.016C71.5581 192.896 71.7721 192.7 71.9561 192.428C72.1441 192.156 72.2921 191.798 72.4001 191.354C72.5121 190.91 72.5681 190.36 72.5681 189.704ZM80.6391 189.704C80.6391 190.456 80.5571 191.108 80.3931 191.66C80.2331 192.208 80.0131 192.662 79.7331 193.022C79.4531 193.382 79.1211 193.65 78.7371 193.826C78.3571 194.002 77.9491 194.09 77.5131 194.09C77.0731 194.09 76.6631 194.002 76.2831 193.826C75.9071 193.65 75.5791 193.382 75.2991 193.022C75.0191 192.662 74.7991 192.208 74.6391 191.66C74.4791 191.108 74.3991 190.456 74.3991 189.704C74.3991 188.952 74.4791 188.3 74.6391 187.748C74.7991 187.196 75.0191 186.74 75.2991 186.38C75.5791 186.016 75.9071 185.746 76.2831 185.57C76.6631 185.394 77.0731 185.306 77.5131 185.306C77.9491 185.306 78.3571 185.394 78.7371 185.57C79.1211 185.746 79.4531 186.016 79.7331 186.38C80.0131 186.74 80.2331 187.196 80.3931 187.748C80.5571 188.3 80.6391 188.952 80.6391 189.704ZM79.5291 189.704C79.5291 189.048 79.4731 188.498 79.3611 188.054C79.2531 187.606 79.1051 187.246 78.9171 186.974C78.7331 186.702 78.5191 186.508 78.2751 186.392C78.0311 186.272 77.7771 186.212 77.5131 186.212C77.2491 186.212 76.9951 186.272 76.7511 186.392C76.5071 186.508 76.2931 186.702 76.1091 186.974C75.9251 187.246 75.7771 187.606 75.6651 188.054C75.5571 188.498 75.5031 189.048 75.5031 189.704C75.5031 190.36 75.5571 190.91 75.6651 191.354C75.7771 191.798 75.9251 192.156 76.1091 192.428C76.2931 192.7 76.5071 192.896 76.7511 193.016C76.9951 193.132 77.2491 193.19 77.5131 193.19C77.7771 193.19 78.0311 193.132 78.2751 193.016C78.5191 192.896 78.7331 192.7 78.9171 192.428C79.1051 192.156 79.2531 191.798 79.3611 191.354C79.4731 190.91 79.5291 190.36 79.5291 189.704Z"
          fill="#656F76"
        />
        <path
          d="M66.2252 239.184V240H61.6172V239.184H63.4592V233.322C63.4592 233.146 63.4652 232.968 63.4772 232.788L61.9472 234.102C61.8952 234.146 61.8432 234.174 61.7912 234.186C61.7392 234.194 61.6912 234.194 61.6472 234.186C61.6032 234.178 61.5612 234.162 61.5212 234.138C61.4852 234.114 61.4572 234.088 61.4372 234.06L61.1012 233.598L63.6632 231.384H64.5332V239.184H66.2252ZM73.6781 235.704C73.6781 236.456 73.5961 237.108 73.4321 237.66C73.2721 238.208 73.0521 238.662 72.7721 239.022C72.4921 239.382 72.1601 239.65 71.7761 239.826C71.3961 240.002 70.9881 240.09 70.5521 240.09C70.1121 240.09 69.7021 240.002 69.3221 239.826C68.9461 239.65 68.6181 239.382 68.3381 239.022C68.0581 238.662 67.8381 238.208 67.6781 237.66C67.5181 237.108 67.4381 236.456 67.4381 235.704C67.4381 234.952 67.5181 234.3 67.6781 233.748C67.8381 233.196 68.0581 232.74 68.3381 232.38C68.6181 232.016 68.9461 231.746 69.3221 231.57C69.7021 231.394 70.1121 231.306 70.5521 231.306C70.9881 231.306 71.3961 231.394 71.7761 231.57C72.1601 231.746 72.4921 232.016 72.7721 232.38C73.0521 232.74 73.2721 233.196 73.4321 233.748C73.5961 234.3 73.6781 234.952 73.6781 235.704ZM72.5681 235.704C72.5681 235.048 72.5121 234.498 72.4001 234.054C72.2921 233.606 72.1441 233.246 71.9561 232.974C71.7721 232.702 71.5581 232.508 71.3141 232.392C71.0701 232.272 70.8161 232.212 70.5521 232.212C70.2881 232.212 70.0341 232.272 69.7901 232.392C69.5461 232.508 69.3321 232.702 69.1481 232.974C68.9641 233.246 68.8161 233.606 68.7041 234.054C68.5961 234.498 68.5421 235.048 68.5421 235.704C68.5421 236.36 68.5961 236.91 68.7041 237.354C68.8161 237.798 68.9641 238.156 69.1481 238.428C69.3321 238.7 69.5461 238.896 69.7901 239.016C70.0341 239.132 70.2881 239.19 70.5521 239.19C70.8161 239.19 71.0701 239.132 71.3141 239.016C71.5581 238.896 71.7721 238.7 71.9561 238.428C72.1441 238.156 72.2921 237.798 72.4001 237.354C72.5121 236.91 72.5681 236.36 72.5681 235.704ZM80.6391 235.704C80.6391 236.456 80.5571 237.108 80.3931 237.66C80.2331 238.208 80.0131 238.662 79.7331 239.022C79.4531 239.382 79.1211 239.65 78.7371 239.826C78.3571 240.002 77.9491 240.09 77.5131 240.09C77.0731 240.09 76.6631 240.002 76.2831 239.826C75.9071 239.65 75.5791 239.382 75.2991 239.022C75.0191 238.662 74.7991 238.208 74.6391 237.66C74.4791 237.108 74.3991 236.456 74.3991 235.704C74.3991 234.952 74.4791 234.3 74.6391 233.748C74.7991 233.196 75.0191 232.74 75.2991 232.38C75.5791 232.016 75.9071 231.746 76.2831 231.57C76.6631 231.394 77.0731 231.306 77.5131 231.306C77.9491 231.306 78.3571 231.394 78.7371 231.57C79.1211 231.746 79.4531 232.016 79.7331 232.38C80.0131 232.74 80.2331 233.196 80.3931 233.748C80.5571 234.3 80.6391 234.952 80.6391 235.704ZM79.5291 235.704C79.5291 235.048 79.4731 234.498 79.3611 234.054C79.2531 233.606 79.1051 233.246 78.9171 232.974C78.7331 232.702 78.5191 232.508 78.2751 232.392C78.0311 232.272 77.7771 232.212 77.5131 232.212C77.2491 232.212 76.9951 232.272 76.7511 232.392C76.5071 232.508 76.2931 232.702 76.1091 232.974C75.9251 233.246 75.7771 233.606 75.6651 234.054C75.5571 234.498 75.5031 235.048 75.5031 235.704C75.5031 236.36 75.5571 236.91 75.6651 237.354C75.7771 237.798 75.9251 238.156 76.1091 238.428C76.2931 238.7 76.5071 238.896 76.7511 239.016C76.9951 239.132 77.2491 239.19 77.5131 239.19C77.7771 239.19 78.0311 239.132 78.2751 239.016C78.5191 238.896 78.7331 238.7 78.9171 238.428C79.1051 238.156 79.2531 237.798 79.3611 237.354C79.4731 236.91 79.5291 236.36 79.5291 235.704Z"
          fill="#656F76"
        />
        <text
          x="60"
          y="107"
          fill={colorOf("text-primary")}
          fontSize={h2FontSize}
          fontWeight="700"
        >
          {"Theme preview"}
        </text>
        <rect
          x="97"
          y="236.539"
          width="18.77"
          height="13.4699"
          fill="#7172AD"
        />
        <rect
          x="97"
          y="206.758"
          width="18.77"
          height="29.7755"
          fill="#509EE3"
        />
        <rect x="97" y="194" width="18.77" height="12.7609" fill="#88BF4D" />
        <rect
          x="132"
          y="232.445"
          width="18.77"
          height="17.5579"
          fill="#7172AD"
        />
        <rect
          x="132"
          y="193.633"
          width="18.77"
          height="38.8122"
          fill="#509EE3"
        />
        <rect x="132" y="177" width="18.77" height="16.6338" fill="#88BF4D" />
        <rect
          x="167"
          y="229.078"
          width="18.77"
          height="20.9251"
          fill="#7172AD"
        />
        <rect
          x="167"
          y="182.824"
          width="18.77"
          height="46.2556"
          fill="#509EE3"
        />
        <rect x="167" y="163" width="18.77" height="19.8238" fill="#88BF4D" />
        <rect
          x="202"
          y="226.191"
          width="18.77"
          height="23.8107"
          fill="#7172AD"
        />
        <rect
          x="202"
          y="173.559"
          width="18.77"
          height="52.6342"
          fill="#509EE3"
        />
        <rect x="202" y="151" width="18.77" height="22.5575" fill="#88BF4D" />
        <rect
          x="237"
          y="221.859"
          width="18.77"
          height="28.1393"
          fill="#7172AD"
        />
        <rect
          x="237"
          y="159.66"
          width="18.77"
          height="62.2027"
          fill="#509EE3"
        />
        <rect x="237" y="133" width="18.77" height="26.6583" fill="#88BF4D" />
      </g>

      <path
        d="M251 251V250H0V251V252H251V251Z"
        fill="#071722"
        fillOpacity="0.14"
        mask="url(#path-1-inside-1_17128_6556)"
      />

      <defs>
        <clipPath id="clip0_17128_6556">
          <path d="M0 0H251V251H0V0Z" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );
};
