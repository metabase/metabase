name: Prepare Python Runner
description: |
  Prepare the Python runner environment for tests. This action starts the python-runner
  service using the Makefile, making it available for Python transform tests and driver tests.

runs:
  using: "composite"
  steps:
    - name: Check if python-runner directory exists
      id: check-python-runner
      shell: bash
      run: |
        if [ -d "python-runner" ]; then
          echo "exists=true" >> $GITHUB_OUTPUT
          echo "✅ python-runner directory found"
          # Echo the current commit for debugging
          echo "📍 Python runner commit:"
          cd python-runner && git rev-parse HEAD && cd ..
        else
          echo "exists=false" >> $GITHUB_OUTPUT
          echo "❌ python-runner directory not found - make sure to checkout with submodules!"
          exit 1
        fi
    
    - name: Start python-runner using Makefile
      if: steps.check-python-runner.outputs.exists == 'true'
      shell: bash
      working-directory: python-runner
      run: |
        echo "🚀 Starting python-runner using make run-all..."
        make run-all
        echo "✅ Python runner started successfully!"